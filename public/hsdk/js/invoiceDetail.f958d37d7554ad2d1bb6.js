(window.deskappJsonp=window.deskappJsonp||[]).push([[103],{"./src/actions/financeInteg/InvoiceActions.js":function(e,t,n){"use strict";(function(e){n.d(t,"n",function(){return m}),n.d(t,"l",function(){return I}),n.d(t,"a",function(){return f}),n.d(t,"k",function(){return v}),n.d(t,"j",function(){return b}),n.d(t,"B",function(){return h}),n.d(t,"A",function(){return y}),n.d(t,"r",function(){return g}),n.d(t,"b",function(){return E}),n.d(t,"q",function(){return O}),n.d(t,"o",function(){return j}),n.d(t,"f",function(){return N}),n.d(t,"g",function(){return T}),n.d(t,"p",function(){return k}),n.d(t,"m",function(){return _}),n.d(t,"t",function(){return S}),n.d(t,"u",function(){return C}),n.d(t,"s",function(){return A}),n.d(t,"z",function(){return Z}),n.d(t,"w",function(){return L}),n.d(t,"d",function(){return M}),n.d(t,"v",function(){return V}),n.d(t,"c",function(){return F}),n.d(t,"x",function(){return z}),n.d(t,"e",function(){return D}),n.d(t,"i",function(){return w}),n.d(t,"h",function(){return x}),n.d(t,"y",function(){return P}),n.d(t,"C",function(){return R});var i=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/selectn/index.js"),c=n.n(i),o=n("./src/constants/index.js"),a=n("./src/reducers/selector.js"),s=n("./src/actions/index.js"),r=n("./src/fz-i18n/index.js"),u=n("./src/utils/RequestAPI.js"),d=n("./src/utils/Common.js"),l=n("./src/utils/departmentQuery.js"),p=n("./src/reducers/financeSelector.js");function m(e,t,n,i){return{types:Object(d.m)("GETINVOICES"),callAPI:function(c){var a=t&&"all"!=t?"&status="+t:"",s="";"Cases"===e&&(s="&departmentId="+c.module.ticket[n].departmentId);var r="pageNumber="+i+"&deskEntityId="+n+"&deskModuleName="+e+a+s;return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(c)+"/invoices?"+r,!1,{orgId:c.currentOrgId}).get().then(function(e){return{data:204!=e.responseStatus?e.data:[],pageNumber:i}})}}}e.ZInvoice={};var I=function(e,t,n,i){return{types:Object(d.m)("GETESTIMATES"),callAPI:function(c){var a="pageNumber="+i+"&deskEntityId="+n+"&deskModuleName="+e+(t&&"all"!=t?"&status="+t:"");return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(c)+"/estimates?"+a,!1,{orgId:c.currentOrgId}).get().then(function(e){return{data:204!=e.responseStatus?e.data:[],pageNumber:i}})}}},f=function(e){return{type:"CHANGE_FINANCE_ENTITY",data:{entity:e.entity,module:e.module,status:e.status}}};function v(e,t){return{types:Object(d.m)("GETACTIVITY"),callAPI:function(n){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(n)+"/contacts/"+e+"/activity?pageNumber="+t,!1,{orgId:n.currentOrgId}).get().then(function(e){return{data:204!=e.responseStatus?e.data:[]}})}}}function b(e){return{types:Object(d.m)("DELINKCONTACT"),callAPI:function(t){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(t)+"/contacts/disassociate?deskEntityId="+e,!1,{orgId:t.currentOrgId}).del().then(function(e){return e})}}}function h(e,t){return{types:Object(d.m)("UPDATE_INVOICE_STATUS"),callAPI:function(n){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(n)+"/invoices/"+e,!1,{orgId:n.currentOrgId}).patch("",{status:t}).then(function(e){return e})}}}function y(e,t){return{types:Object(d.m)("UPDATE_ESTIMATE_STATUS"),callAPI:function(n){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(n)+"/estimates/"+e,!1,{orgId:n.currentOrgId}).patch("",{status:t}).then(function(e){return e})}}}function g(e){return{types:Object(d.m)("MARKALL_INVOICE_SENT"),callAPI:function(t){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(t)+"/invoices/markAsSent",!1,{orgId:t.currentOrgId}).post("",{ids:e}).then(function(e){return e})}}}var E=function(){return{type:"CLEAR_SELECTED_FINANCE_ENTITIES"}};function O(e){return{types:Object(d.m)("MARKALL_ESTIMATE_SENT"),callAPI:function(t){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(t)+"/estimates/markAsSent",!1,{orgId:t.currentOrgId}).post("",{ids:e}).then(function(e){return e})}}}function j(){return{types:Object(d.m)("GET_PAYMENTMETA"),callAPI:function(e){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(e)+"/paymentTermsMeta",!1,{orgId:e.currentOrgId}).get().then(function(e){return e})}}}function N(e){return{types:Object(d.m)("CREATE_CONTACT"),callAPI:function(t,n){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(t)+"/contacts",!1,{orgId:t.currentOrgId}).post("",e).then(function(e){return e})}}}function T(e,t){return{types:Object(d.m)("CREATE_CONTACT_MAPPING"),callAPI:function(n,i){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(n)+"/contacts/"+t,!1,{orgId:n.currentOrgId}).patch("",e).then(function(e){return e})}}}function k(e){return{types:Object(d.m)("GET_UNBILLED_TIMEENTRY"),callAPI:function(t){return Object(u.a)(e,!1,{orgId:t.currentOrgId}).get().then(function(e){return e})}}}function _(e){return{types:Object(d.m)("GET_FINACE_ENTITY"),callAPI:function(t){return Object(u.a)(e,!1,{orgId:t.currentOrgId}).get().then(function(e){return e})}}}function S(e,t){return{type:"CHANGE_INVOICE_MODULE",data:{module:e,status:t}}}function C(e){return{type:"CHANGE_INVOICE_STATUS",data:{status:e}}}function A(e){return{type:"SELECT_INVOICE",data:{selectedItem:e}}}function Z(){return{type:"RESET_INVOICE_DEFAULT_DATA"}}function L(e){return{type:"OPEN_INVOICE_DETAILS",data:e}}function M(){return{type:"CLOSE_INVOICE_DETAILS"}}function V(e){return{type:"OPEN_INVOICE_IFRAME_FORM",data:e}}function F(){return{type:"CLOSE_INVOICE_IFRAME_FORM"}}function z(e){return{type:"OPEN_INVOICE_FORM",data:e}}function D(){return{type:"CLOSE_INVOICE_FORM"}}var B=function(e){var t=e.integrations,n=Object(a.L)(e),i=o.m[n],s=e.routing.paramMap.moduleId,r=e.module[i.stateKey][s];return{integrations:t,moduleId:s,contactId:"tickets"===n?r.contactId:s,moduleData:r,deskModuleName:i.deskModuleName,orgName:Object(a.U)(e),financeContact:c()("financeInfo.financeContact",e)||{}}},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n,i){var c=i(),a=B(c),s=a.moduleId,r=a.deskModuleName,m=a.moduleData,I=a.orgName,f=a.financeContact,v=a.integrations;ZInvoice.entityType="invoice",ZInvoice.isDetailView=!1,ZInvoice.includeTimeEntries=!1;var b=function(i){if(!i){ZInvoice.isHasUnbilledTimeEntries=!1,"Cases"===r?(ZInvoice.caseSubject="[## "+m.ticketNumber+" ##] "+m.subject,ZInvoice.caseId=m.id):(ZInvoice.caseSubject="",ZInvoice.caseId="");var o="/support/"+I+"/connectzb?entityType=2&acceptJHTML=true&entityid="+f.id+"&accountType="+Object(p.a)(c);return n(V({isOpen:!0,src:o,openFinance:e}))}ZInvoice.includeTimeEntries=!0,ZInvoice.isHasUnbilledTimeEntries=!0;var a=t.timeEntryIds;return n(z({type:"invoiceForm",data:{isPreferenceOpen:!0,financeContact:f,timeEntryIds:void 0===a?[]:a},accountType:"ENABLED"==v.INVOICE.status?"invoice":"books",entity:"invoice"}))},h=t.timeEntryIds;return(void 0===h?[]:h).length?b(!0):n(function(e,t){var n={Cases:"tickets",Contacts:"contacts",Accounts:"accounts"};return{types:Object(d.m)("HAS_UNBILLED_TIMEENTRY"),callAPI:function(i){var c="Cases"!=t?Object(l.a)(i,!0):"",a=""+o.B+n[t]+"/"+e+"/timeEntry?isBillable=true"+c;return Object(u.a)(a,!1,{orgId:i.currentOrgId}).get().then(function(e){return{hasUnBilledTimeEntry:204!=e.responseStatus&&e.data.some(function(e){return null==e.invoiceId})}})}}}(s,r)).then(function(e){return b(e.data.hasUnBilledTimeEntry)})}},x=function(e){return function(t,n){var i=n(),c=B(i),o=c.moduleData,a=c.deskModuleName,s=c.orgName,r=c.financeContact;return ZInvoice.includeTimeEntries=!1,ZInvoice.isDetailView=!1,ZInvoice.entityType="estimate","Cases"===a?(ZInvoice.caseSubject="[## "+o.ticketNumber+" ##] "+o.subject,ZInvoice.caseId=o.id):(ZInvoice.caseSubject="",ZInvoice.caseId=""),t(V({isOpen:!0,src:"/support/"+s+"/connectzb?entityType=1&acceptJHTML=true&entityid="+r.id+"&accountType="+Object(p.a)(i),openFinance:e}))}},P=function(e,t,n){return function(i,c){var a=c(),l=B(a),m=l.contactId,I=l.deskModuleName,f=l.integrations;return i(function(e,t){return{types:Object(d.m)("SEARCHCONTACTS"),callAPI:function(n){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(n)+"/contacts/search?deskEntityId="+e+"&deskModuleName="+t,!1,{orgId:n.currentOrgId}).get().then(function(e){return e})}}}(m,I)).then(function(c){return c.data&&"contactId"==c.data.matchedBy?i(function(e,t){return{types:Object(d.m)("FINANCECONTACT"),callAPI:function(n){return Object(u.a)(o.B+"zohoFinance/"+Object(p.c)(n)+"/contacts?deskEntityId="+e+"&deskModuleName="+t,!1,{orgId:n.currentOrgId}).get().then(function(e){return e})}}}(m,I)).then(function(){"invoice"===t?i(w(e,n)):"estimate"===t?i(x(e)):e()}):(i(z({type:"invoiceForm",data:204!=c.data.responseStatus?c.data:null,accountType:"ENABLED"==f.INVOICE.status?"invoice":"books",openFinance:e,entity:t})),{isInvoiceInfoOpen:!1})}).catch(function(e){throw i(Object(s.Q)({type:"alert",message:r.h.getI18NValue("support.invoice.integ.email.error")})),e})}},R=function(e,t,n,i){return function(c,o){ZInvoice.entityId=e;var s=o(),r=Object(a.U)(s),u=Object(p.b)(s),d="/support/"+r+"/connectzb?entityType="+("invoice"==t?"12":"13")+"&acceptJHTML=true&entityid="+e+"&accountType="+Object(p.a)(s);c(L({isOpen:!0,invoiceId:e,type:t,status:n,src:d,permissions:u})),i&&i(),ZInvoice.isShowIframe&&c({type:"CLOSE_INVOICE_IFRAME_FORM"})}}}).call(this,n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/webpack/buildin/global.js"))},"./src/actions/financeInteg/zInvoiceInit.js":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return p});var i=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/typeof.js"),c=n.n(i),o=n("./src/actions/financeInteg/InvoiceActions.js"),a=n("./src/reducers/selector.js"),s=n("./src/fz-i18n/index.js"),r=n("./src/actions/index.js"),u=n("./src/constants/index.js"),d=n("./src/utils/Common.js"),l=n("./src/reducers/financeSelector.js"),p=function(t){return function(n,i){function p(){var e=i().financeInfo,t=e.selectedModule,c=e.selectedStatus;"invoices"===ZInvoice.entityType||"invoice"===ZInvoice.entityType?n(Object(o.a)({entity:"invoice",module:t,status:c})):"estimates"!==ZInvoice.entityType&&"estimate"!==ZInvoice.entityType||n(Object(o.a)({entity:"estimate",module:t,status:c})),ZInvoice.saveAndSend=!1,ZInvoice.refreshList=!1}e.ZInvoice.saveAndSend=!0,e.setZFIframeHeight=function(){m()},e.setIFrameHeight=function(){m()},e.scroll=function(){ZInvoice.scrollCont.scrollTop=0},e.csrfParamName="crmcsrfparam",e.csrfToken=Object(d.p)(),e.closeZBInvoiceIFrame=function(){ZInvoice.caseId="";var e=i();ZInvoice.saveAndSend&&!0===ZInvoice.refreshList&&p(),e.invoiceIframeFormInfo.isOpen?n(Object(o.c)()):n(Object(o.d)())},e.procZInvoiceResp=function(e,i,a,u){var d=void 0,l=void 0;try{d=(l="object"===(void 0===e?"undefined":c()(e))?e:jQuery.parseJSON(e)).code}catch(e){return void n(Object(r.Q)({type:"alert",message:s.h.getI18NValue("support.unable.to.process.your.request")}))}ZInvoice.saveAndSend=a,0==d&&(n(Object(r.Q)({type:"success",message:l.message})),ZInvoice.caseId="",ZInvoice.isShowIframe=!0,!0===ZInvoice.refreshList?("invoices"===ZInvoice.entityType||"invoice"===ZInvoice.entityType?n(Object(o.C)(ZInvoice.entityId,"invoice","sent",t)):"estimates"!==ZInvoice.entityType&&"estimate"!==ZInvoice.entityType||n(Object(o.C)(ZInvoice.entityId,"estimate","sent",t)),p(),ZInvoice.refreshList=!1,ZInvoice.saveAndSend=!1):a||(null!=l.estimate&&null!=l.estimate?n(Object(o.C)(l.estimate.estimate_id,"estimate",l.estimate.status,t)):null!=l.invoice&&null!=l.invoice&&n(Object(o.C)(l.invoice.invoice_id,"invoice",l.invoice.status,t)),p())),a&&ZInvoice.processSaveAndSend(l)},ZInvoice.setupDevelopmentURL=function(){},ZInvoice.loadPDF=function(e,t){var n=i(),c=Object(a.U)(n);window.location.href="/support/"+c+"/connectzb?entityType="+e+"&entityid="+t+"&accountType="+Object(l.a)(n)},ZInvoice.downloadZFJsp=function(e,t,c){var s=i(),r="/support/"+Object(a.U)(s)+"/connectzb?acceptJHTML=true&entityid="+t+"&accountType="+Object(l.a)(s);ZInvoice.isDetailView=!1;var d="";c?(ZInvoice.refreshList=!0,d=e?u.y.INVOICE_EMAIL_GET:u.y.ESTIMATE_EMAIL_GET):(ZInvoice.refreshList=!1,d=e?u.y.ZB_INVOICE_EDIT:u.y.ZB_ESTIMATE_EDIT),r+="&entityType="+d,n(Object(o.v)({isOpen:!0,src:r}))},ZInvoice.processSaveAndSend=function(e){var i=!1,c=void 0;e.hasOwnProperty("invoice")?(c=e.invoice.invoice_id,ZInvoice.isShowIframe=!1,n(Object(o.C)(c,"invoice",e.invoice.status,t)),i=!0):e.hasOwnProperty("estimate")&&(c=e.estimate.estimate_id,ZInvoice.isShowIframe=!1,n(Object(o.C)(c,"estimate",e.estimate.status,t))),ZInvoice.downloadZFJsp(i,c,!0)},ZInvoice.getTimeEntryJSON=function(){n(Object(o.x)({type:"invoiceForm",data:{isPreferenceOpen:!0,needJSONresponse:!0},accountType:"invoice",entity:"invoice"}))},ZInvoice.devObject={userParam:null,branchParam:null}}};function m(){if(ZInvoice.iframe){var e=ZInvoice.iframe.contentDocument.getElementsByClassName("body")[0];if(e){var t=e.offsetHeight+100;ZInvoice.iframe.setAttribute("height",t+"px")}}if(ZInvoice.dvIframe){var n=ZInvoice.dvIframe.contentDocument.getElementsByTagName("body")[0];if(n){var i=n.offsetHeight+100;ZInvoice.dvIframe.setAttribute("height",i+"px")}}}}).call(this,n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/webpack/buildin/global.js"))},"./src/components/Subtab/Loading/Loading.js":function(e,t,n){"use strict";var i=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),c=n.n(i),o=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/classCallCheck.js"),a=n.n(o),s=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/createClass.js"),r=n.n(s),u=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),d=n.n(u),l=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/inherits.js"),p=n.n(l),m=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js"),I=n.n(m),f=n("./src/components/Subtab/Loading/SubtabLoading.module.css"),v=n.n(f),b=n("../components/lib/Layout/index.js"),h=function(e){function t(){return a()(this,t),d()(this,(t.__proto__||c()(t)).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){return I.a.createElement(b.Container,{alignBox:"row",align:"both",className:v.a.container},I.a.createElement(b.Box,{className:v.a.dot}),I.a.createElement(b.Box,{className:v.a.dot}),I.a.createElement(b.Box,{className:v.a.dot}),I.a.createElement(b.Box,{className:v.a.dot}),I.a.createElement(b.Box,{className:v.a.dot}),I.a.createElement(b.Box,{className:v.a.dot}))}}]),t}(I.a.Component);t.a=h},"./src/containers/Subtab/InvoiceDetail/InvoiceDetail.js":function(e,t,n){"use strict";n.r(t);var i=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),c=n.n(i),o=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/classCallCheck.js"),a=n.n(o),s=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/createClass.js"),r=n.n(s),u=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),d=n.n(u),l=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/inherits.js"),p=n.n(l),m=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js"),I=n.n(m),f=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react-dom/index.js"),v=n.n(f),b=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/prop-types/index.js"),h=n.n(b),y=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react-redux/es/index.js"),g=n("./src/containers/Subtab/InvoiceDetail/InvoiceDetail.module.css"),E=n.n(g),O=n("./src/actions/financeInteg/InvoiceActions.js"),j=n("./src/actions/index.js"),N=n("./node_modules/@zohodesk/icons/lib/Icon/index.js"),T=n.n(N),k=n("../components/lib/Layout/index.js"),_=n("./src/components/Subtab/Loading/Loading.js"),S=n("./src/fz-i18n/index.js"),C=n("./src/reducers/selector.js"),A=n("./src/constants/index.js"),Z=n("./src/actions/financeInteg/zInvoiceInit.js"),L=n("./src/reducers/financeSelector.js"),M=function(e){function t(e){a()(this,t);var n=d()(this,(t.__proto__||c()(t)).call(this,e));return n.state={},n.onLoad=n.onLoad.bind(n),n.updateStatus=n.updateStatus.bind(n),n.statusSuccessCallback=n.statusSuccessCallback.bind(n),n.viewFinace=n.viewFinace.bind(n),n.cloneEntity=n.cloneEntity.bind(n),n.convertEstimateToInvoice=n.convertEstimateToInvoice.bind(n),n}return p()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.props.invoiceInit(),this.setState({isFrameLoaded:!1})}},{key:"componentDidUpdate",value:function(e){e.info.invoiceId!=this.props.info.invoiceId&&this.setState({isFrameLoaded:!1})}},{key:"componentWillUnmount",value:function(){ZInvoice.dvIframe=null,this.props.closeInvoiceDetails()}},{key:"onLoad",value:function(){this.setState({isFrameLoaded:!0});var e=this.props.info,t=e.type,n=e.status,i=e.invoiceId,c=e.permissions;if("invoice"==t&&c.createInvoice||"estimate"==t&&c.createEstimate){var o=ZInvoice.dvIframe.contentDocument.getElementById("btnToolbar"),a=document.createElement("div");a.setAttribute("id","deskTab"),o.appendChild(a);var s=ZInvoice.dvIframe.contentDocument.getElementById("deskTab");v.a.render(this.constructMoreObj(n,i,t),s)}}},{key:"updateStatus",value:function(e,t,n){var i=this,c=this.props,o=c.updateInvoiceStatus,a=c.updateEstimateStatus;"invoice"==e?o(t,n).then(function(){i.statusSuccessCallback(e,n),i.viewFinace(t,e,n)}):a(t,n).then(function(){i.statusSuccessCallback(e,n),i.viewFinace(t,e,n)})}},{key:"statusSuccessCallback",value:function(e,t){var n=this.props,i=n.showMessage,c=n.selectedModule,o=n.selectedStatus,a=n.ticket,s=n.contactId,r=n.getInvoices,u=n.getEstimates,d=n.deskModuleName,l=n.ticketSelectedLabel,p=s,m=d,I=o.toLowerCase().replace(" ","_");"Cases"===d&&(c===l?p=a.id:m="Contacts"),"invoice"==e?(i({type:"success",message:S.h.getI18NValue("support.finance.staus.update",[S.h.getI18NValue("support.invoice.label.for.ticket"),t])}),r(m,I,p,1)):(i({type:"success",message:S.h.getI18NValue("support.finance.staus.update",[S.h.getI18NValue("support.estimate.label.for.ticket"),t])}),u(m,I,p,1))}},{key:"viewFinace",value:function(e,t,n){ZInvoice.entityId=e;var i=this.props,c=i.financePermissions,o=i.orgName,a=i.openInvoiceDetails,s="/support/"+o+"/connectzb?entityType="+("invoice"==t?"12":"13")+"&acceptJHTML=true&entityid="+e+"&accountType="+i.accountType;a({isOpen:!0,invoiceId:e,type:t,status:n,src:s,permissions:c}),ZInvoice.dvIframe.src=s}},{key:"cloneEntity",value:function(e,t){var n=this.props,i=n.orgName,c=n.openIframeForm,o=n.accountType;ZInvoice.isDetailView=!1,ZInvoice.entityType=t,c({isOpen:!0,src:"/support/"+i+"/connectzb?entityType="+("invoices"===t||"invoice"===t?A.y.ZB_INVOICE_CLONE:A.y.ZB_ESTIMATE_CLONE)+"&acceptJHTML=true&entityid="+e+"&accountType="+o})}},{key:"convertEstimateToInvoice",value:function(e){var t=this.props,n=t.ticket,i=t.orgName,c=t.openIframeForm,o=t.deskModuleName,a=t.accountType;ZInvoice.isDetailView=!1,ZInvoice.entityType="invoices","Cases"===o&&(ZInvoice.caseId=n.id),c({isOpen:!0,src:"/support/"+i+"/connectzb?entityType="+A.y.ZB_ESTIMATE_TO_INVOICE+"&acceptJHTML=true&entityid="+e+"&accountType="+a})}},{key:"constructMoreObj",value:function(e,t,n){var i=[];return i="invoice"==n?"sent"==e?[{name:S.h.getI18NValue("support.finance.void.invoice"),click:this.updateStatus.bind(this,n,t,"void")},{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"draft"==e?[{name:S.h.getI18NValue("support.finance.mark.as.sent"),click:this.updateStatus.bind(this,n,t,"sent")},{name:S.h.getI18NValue("support.finance.void.invoice"),click:this.updateStatus.bind(this,n,t,"void")},{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"void"==e?[{name:S.h.getI18NValue("support.finance.convert.to.draft"),click:this.updateStatus.bind(this,n,t,"draft")},{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"overdue"==e?[{name:S.h.getI18NValue("support.finance.void.invoice"),click:this.updateStatus.bind(this,n,t,"void")},{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:[{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"draft"==e?[{name:S.h.getI18NValue("support.finance.mark.as.sent"),click:this.updateStatus.bind(this,n,t,"sent")},{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"sent"==e?[{name:S.h.getI18NValue("support.finance.mark.as.accepted"),click:this.updateStatus.bind(this,n,t,"accepted")},{name:S.h.getI18NValue("support.finance.mark.as.declined"),click:this.updateStatus.bind(this,n,t,"declined")},{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"accepted"==e?[{name:S.h.getI18NValue("support.finance.mark.as.declined"),click:this.updateStatus.bind(this,n,t,"declined")},{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"declined"==e?[{name:S.h.getI18NValue("support.finance.mark.as.accepted"),click:this.updateStatus.bind(this,n,t,"accepted")},{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:[{name:S.h.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}],I.a.createElement("div",{style:{right:"86px",float:"right",position:"absolute",top:"22px"}},"estimate"==n&&"declined"!=e?I.a.createElement("button",{className:"btn-blue",onClick:this.convertEstimateToInvoice.bind(this,t),style:{float:"left",marginRight:"12px",padding:"5px 12px"},type:"button"},S.h.getI18NValue("support.finance.convert.to.invoice")):null,I.a.createElement("div",{className:"btn-group"},I.a.createElement("button",{className:"btn dropdown-toggle btn-default","data-test-button":"more-options","data-toggle":"dropdown"},S.h.getI18NValue("crm.label.More")," ",I.a.createElement("b",{className:"caret"})),I.a.createElement("ul",{className:"dropdown-menu pull-right"},i.map(function(e,t){return I.a.createElement("li",{"data-test-title":"associate-template",key:t,onClick:e.click},I.a.createElement("a",{"data-ember-action":""},e.name))}))))}},{key:"render",value:function(){var e=this.props,t=e.closeInvoiceDetails,n=e.info,i=this.state.isFrameLoaded;return I.a.createElement(k.Container,{className:E.a.container,ref:function(e){ZInvoice.scrollCont=e},scroll:"both"},I.a.createElement("span",{className:E.a.closeIcon,onClick:t},I.a.createElement(T.a,{name:"ZD-close2"})),I.a.createElement("iframe",{onLoad:this.onLoad,ref:function(e){ZInvoice.dvIframe=e},src:n.src,style:{width:"100%",position:"absolute"}}),i?null:I.a.createElement("div",{className:E.a.loadingCont},I.a.createElement(_.a,null)))}}]),t}(m.Component);M.propTypes={accountType:h.a.string,closeInvoiceDetails:h.a.func,contactId:h.a.string,deskModuleName:h.a.string,financePermissions:h.a.object,getEstimates:h.a.func,getInvoices:h.a.func,info:h.a.object,invoiceInit:h.a.func,openIframeForm:h.a.func,openInvoiceDetails:h.a.func,orgName:h.a.string,selectedModule:h.a.string,selectedStatus:h.a.string,showMessage:h.a.func,ticket:h.a.object,ticketSelectedLabel:h.a.string,updateEstimateStatus:h.a.func,updateInvoiceStatus:h.a.func},t.default=Object(y.connect)(function(e){var t=e.moduleMeta,n=e.moduleMapper[e.routing.paramMap.moduleName],i=A.m[n],c=e.financeInfo,o=c.selectedModule,a=void 0===o?S.h.getI18NValue("support.finance.module.invoices",[t.tickets.singularLabel]):o,s=c.selectedStatus,r=void 0===s?S.h.getI18NValue("support.finance.status.all"):s,u=e.routing.paramMap.moduleId,d="tickets"===n?e.module.ticket[u]:null,l="tickets"===n?d.contactId:u,p=S.h.getI18NValue("support.finance.module.invoices",[e.moduleMeta.tickets.singularLabel]);return{accountType:Object(L.a)(e),ticketSelectedLabel:p,deskModuleName:i.deskModuleName,selectedModule:a,selectedStatus:r,ticket:d,contactId:l,orgName:Object(C.U)(e),financePermissions:Object(L.b)(e)}},{closeInvoiceDetails:O.d,updateInvoiceStatus:O.B,updateEstimateStatus:O.A,showMessage:j.Q,getInvoices:O.n,getEstimates:O.l,openInvoiceDetails:O.w,openIframeForm:O.v,invoiceInit:Z.a})(M)},"./src/containers/Subtab/InvoiceDetail/InvoiceDetail.module.css":function(e,t,n){e.exports={container:"zd-invoicedetail-container",closeIcon:"zd-invoicedetail-closeIcon",loadingCont:"zd-invoicedetail-loadingCont"}},"./src/reducers/financeSelector.js":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return o});var i=function(e){return e.module.profile[e.myInfo.profileId].permissions.financeInteg},c=function(e){return"ENABLED"===e.integrations.INVOICE.status?"invoice":"ENABLED"===e.integrations.BOOKS.status?"books":null},o=function(e){return"ENABLED"===e.integrations.INVOICE.status?"ZohoInvoice":"ENABLED"===e.integrations.BOOKS.status?"ZohoBooks":null}}}]);