(window.deskappJsonp=window.deskappJsonp||[]).push([[146],{"../components/lib/Tag/Tag.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js"),o=d(s),l=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/prop-types/index.js"),r=d(a("../components/node_modules/@zohodesk/icons/lib/Icon/index.js")),i=d(a("../components/lib/Avatar/Avatar.js")),c=d(a("../components/lib/Tag/Tag.module.css"));function d(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleSelect=a.handleSelect.bind(a),a.handleRemove=a.handleRemove.bind(a),a.getRef=a.getRef.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.PureComponent),n(t,[{key:"handleSelect",value:function(e){var t=this.props,a=t.id,n=t.onSelectTag,s=void 0===n?null:n;e&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.nativeEvent.stopImmediatePropagation&&e.nativeEvent.stopImmediatePropagation(),s&&s(a,e)}},{key:"handleRemove",value:function(e){var t=this.props,a=t.onRemove,n=t.id;e&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.nativeEvent.stopImmediatePropagation&&e.nativeEvent.stopImmediatePropagation(),a&&a(n)}},{key:"getRef",value:function(e){var t=this.props,a=t.getRef,n=t.id;a&&a(e,n)}},{key:"render",value:function(){var e=this.props,t=e.imageURL,a=e.hasAvatar,n=e.text,s=e.onRemove,l=e.initial,d=e.active,u=e.size,p=e.rounded,m=e.palette,h=e.disabled,g=e.closePalette,f=e.onSelectTag,b=e.closeTitle,v=e.dataId,T=e.className,y=e.iconName,S=e.iconSize;return o.default.createElement("div",{className:c.default.container+" "+(d?c.default.selected:"")+" "+(s?c.default.effect:"")+"  "+c.default[u]+" "+(p?c.default.lgRadius:c.default.smRadius)+" "+c.default[m]+" "+(h?c.default.disabled:"")+" "+(f?c.default.pointer:"")+" "+(T||""),"data-id":d?v+"_TagSelected":v+"_Tag",onClick:this.handleSelect,ref:this.getRef},a?o.default.createElement("div",{className:c.default.avatar},o.default.createElement(i.default,{name:l,size:"small",src:t})):null,y?o.default.createElement("div",{className:c.default.icon},o.default.createElement(r.default,{name:y,size:S})):null,o.default.createElement("div",{className:c.default.text,"data-title":n},n),s&&o.default.createElement("div",{className:c.default.close+" "+c.default["close"+g],"data-id":v+"_RemoveTag","data-title":b,onClick:this.handleRemove},o.default.createElement(r.default,{isBold:!0,name:"ZD-close2",size:"8"})))}}]),t}();t.default=u,u.defaultProps={active:!1,closePalette:"danger",hasAvatar:!1,palette:"default",rounded:!0,size:"medium",dataId:"tag"},u.propTypes={active:l.PropTypes.bool,className:l.PropTypes.string,closePalette:l.PropTypes.oneOf(["danger","primary"]),closeTitle:l.PropTypes.string,dataId:l.PropTypes.string,disabled:l.PropTypes.bool,getRef:l.PropTypes.func,hasAvatar:l.PropTypes.bool,iconName:l.PropTypes.string,iconSize:l.PropTypes.string,id:l.PropTypes.oneOfType([l.PropTypes.string,l.PropTypes.number]),imageURL:l.PropTypes.string,initial:l.PropTypes.string,onRemove:l.PropTypes.func,onSelectTag:l.PropTypes.func,palette:l.PropTypes.oneOf(["default","danger","secondary","pureDotted","primaryDotted"]),rounded:l.PropTypes.bool,size:l.PropTypes.oneOf(["small","medium"]),text:l.PropTypes.oneOfType([l.PropTypes.string,l.PropTypes.number])},u.propTypesDescription={hasAvatar:" ",onRemove:" ",active:" ",onSelectTag:" ",text:" ",imageURL:" ",id:" ",initial:" ",size:" ",rounded:" ",palette:" ",closePalette:" ",disabled:" ",getRef:" ",closeTitle:" "}},"./src/components/SearchResults/SearchResults.js":function(e,t,a){"use strict";var n=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),s=a.n(n),o=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/classCallCheck.js"),l=a.n(o),r=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/createClass.js"),i=a.n(r),c=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),d=a.n(c),u=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/inherits.js"),p=a.n(u),m=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js"),h=a.n(m),g=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/prop-types/index.js"),f=a.n(g),b=a("./src/components/SearchResults/SearchResults.module.css"),v=a.n(b),T=a("../components/lib/Avatar/Avatar.js"),y=a.n(T),S=a("../components/lib/DropBox/DropBox.js"),x=a.n(S),_=a("../components/lib/Layout/index.js"),E=a("./src/utils/Common.js"),k=a("./src/fz-i18n/index.js"),j=function(e){function t(e){l()(this,t);var a=d()(this,(t.__proto__||s()(t)).call(this,e));return a.getScrollContainerRef=a.getScrollContainerRef.bind(a),a.getSelectedItemRef=a.getSelectedItemRef.bind(a),a.onScroll=a.onScroll.bind(a),a.isFetching=!1,a}return p()(t,e),i()(t,[{key:"getScrollContainerRef",value:function(e){this.scrollContainerRef=e}},{key:"getSelectedItemRef",value:function(e){this.selectItemRef=e}},{key:"componentDidUpdate",value:function(){var e=this.props.selectSearchIndex,t=this.scrollContainerRef,a=this.selectItemRef;if(a&&t){var n=a.offsetTop-t.scrollTop,s=a.offsetHeight,o=t.offsetHeight;(n<0||s+n>o)&&(t.scrollTop=0==e?0:t.scrollTop+n)}}},{key:"onScroll",value:function(e){var t=this;if(this.props.fetchData&&!this.isFetching){var a=e.currentTarget;a.scrollHeight<=a.scrollTop+a.offsetHeight&&(this.isFetching=!0,this.props.fetchData().then(function(){t.isFetching=!1},function(){t.isFetching=!1}))}}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.dataId,s=t.orgName,o=(t.selectEmail,t.type),l=t.selectSearchIndex,r=(t.addTag,t.needFixed),i=t.needAvatar,c=t.onSelect;return h.a.createElement(x.a,{onScroll:this.onScroll,isArrow:!1,boxPosition:"bottomCenter",isActive:!0,className:""+(r?v.a.resetDropbox:"")},h.a.createElement("div",{ref:this.getScrollContainerRef,className:i?v.a.agentSearch:v.a.tagsSearch},a.length?a.map(function(t,a){var r=t.id,d=t.name,u=t.email,p=t.isNew,m=t.firstName,g=t.lastName,f=t.photoURL,b=t.newLabel,T=i&&f?f+"?portalname="+s:null;i&&Object(E.g)(m,g);return d=i?Object(E.e)(m,g):d,h.a.createElement(_.Container,{alignBox:"row",align:"vertical",className:v.a.asItem+" "+(l==a?v.a.selectIem:""),onMouseDown:function(){c(t,o)},eleRef:a==l?e.getSelectedItemRef:null,key:a,dataId:n+"_"+r},i?h.a.createElement(_.Box,{className:v.a.imgCont},h.a.createElement(y.a,{src:T,name:d,size:"medium"})):null,h.a.createElement(_.Box,{flexible:!0},h.a.createElement("div",{className:v.a.ashead},p?h.a.createElement("span",{className:v.a.newTag},b):null,d),u?h.a.createElement("div",{className:v.a.asemail},u):null))}):h.a.createElement("div",{className:v.a.searchDiv},k.h.getI18NValue("support.label.searching"))))}}]),t}(h.a.Component);t.a=j,j.propTypes={addTag:f.a.func,data:f.a.array,dataId:f.a.string,fetchData:f.a.oneOfType([f.a.func,f.a.bool]),isPopupOpen:f.a.bool,needAvatar:f.a.bool,orgName:f.a.string,placeholder:f.a.string,removeClose:f.a.func,selectEmail:f.a.func,selectSearchIndex:f.a.number,theme:f.a.string,togglePopup:f.a.func,type:f.a.string},j.defaultProps={data:[],needAvatar:!0}},"./src/components/Subtab/Tags/SubtabTags.module.css":function(e,t,a){e.exports={tagCont:"zd-subtabtags-tagCont",inputDiv:"zd-subtabtags-inputDiv",shortcutKey:"zd-subtabtags-shortcutKey",close:"zd-subtabtags-close",closeText:"zd-subtabtags-closeText",tagDiv:"zd-subtabtags-tagDiv",tag:"zd-subtabtags-tag",errorMsg:"zd-subtabtags-errorMsg",errorContent:"zd-subtabtags-errorContent"}},"./src/containers/Subtab/TagsContainer/TagsContainer.js":function(e,t,a){"use strict";a.r(t);var n=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/promise.js"),s=a.n(n),o=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=a.n(o),r=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/classCallCheck.js"),i=a.n(r),c=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/createClass.js"),d=a.n(c),u=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),p=a.n(u),m=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/inherits.js"),h=a.n(m),g=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js"),f=a.n(g),b=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/prop-types/index.js"),v=a.n(b),T=a("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react-redux/es/index.js"),y=a("./src/components/Subtab/Tags/SubtabTags.module.css"),S=a.n(y),x=a("../components/lib/Layout/index.js"),_=a("./node_modules/@zohodesk/icons/lib/Icon/index.js"),E=a.n(_),k=a("./src/fz-i18n/index.js"),j=a("../components/lib/Tag/Tag.js"),C=a.n(j),R=a("../components/lib/TextBox/TextBox.js"),I=a.n(R),N=a("./src/components/SearchResults/SearchResults.js"),P=a("./src/components/VelocityAnimation/VelocityAnimationGroup/VelocityAnimationGroup.js"),z=function(e){function t(){return i()(this,t),p()(this,(t.__proto__||l()(t)).apply(this,arguments))}return h()(t,e),d()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.handleKeyUp,n=t.handleChange,s=t.closeSearch,o=t.searchList,l=t.selectSearchIndex,r=t.addTag,i=t.searchTags,c=t.noMoreData,d=t.showErrorMsg,u=t.tagsList,p=t.toggleTags,m=t.deleteTag,h=t.name,g=t.isReadOnly,b=t.isActive;return f.a.createElement(P.a,{isActive:b,name:"slideDown",component:f.a.Fragment},f.a.createElement("div",{className:S.a.tagCont},f.a.createElement(x.Container,{alignBox:"row"},f.a.createElement(x.Box,{flexible:!0},f.a.createElement(x.Container,{alignBox:"column"},f.a.createElement(x.Box,{className:S.a.topDiv},f.a.createElement("div",{className:S.a.inputDiv},f.a.createElement(I.a,{dataId:"tagInp",placeHolder:k.h.getI18NValue("support.request.create.tag"),value:h,onKeyUp:a,onChange:n,onBlur:s,maxLength:50,isReadOnly:g}),o.length?f.a.createElement("span",null,f.a.createElement(N.a,{data:o,selectSearchIndex:l,needAvatar:!1,onSelect:r,fetchData:!c&&i})):null),g?null:f.a.createElement("div",{className:S.a.shortcutKey},"Shift + T"),d?f.a.createElement("div",{className:S.a.errorMsg},f.a.createElement(E.a,{name:"ZD-information57"}),f.a.createElement("div",{className:S.a.errorContent,"data-id":"ExtraTag"},k.h.getI18NValue("support.request.maxium.tag"))):null),f.a.createElement(x.Box,{className:S.a.tagDiv},u.length?u.map(function(t,a){var n=t.name,s=t.tagType;return f.a.createElement("span",{className:S.a.tag,key:a},f.a.createElement(C.a,{text:n,onRemove:m.bind(e,n),closeTitle:k.h.getI18NValue("support.label.delete.tag"),palette:"SYSTEM"==s?"primary":"default",onSelectTag:function(){},disabled:g}))}):null))),f.a.createElement(x.Box,{className:S.a.close,onClick:p},f.a.createElement(E.a,{name:"ZD-closee"}),f.a.createElement("span",{className:S.a.closeText},k.h.getI18NValue("crm.label.close"))))))}}]),t}(f.a.Component),w=z;z.propTypes={addTag:v.a.func,closeSearch:v.a.func,deleteTag:v.a.func,handleChange:v.a.func,handleKeyUp:v.a.func,isActive:v.a.bool,isReadOnly:v.a.bool,name:v.a.string,noMoreData:v.a.bool,searchList:v.a.array,searchTags:v.a.func,selectSearchIndex:v.a.string,showErrorMsg:v.a.func,tagsList:v.a.array,toggleTags:v.a.func};var L=a("./src/tickets/actions/tag/index.js"),D=function(e){function t(e){i()(this,t);var a=p()(this,(t.__proto__||l()(t)).call(this,e));return a.state={tagsList:[],searchList:[],name:"",from:1,limit:10,selectSearchIndex:-1,noMoreData:!0,showErrorMsg:!1},a.handleChange=a.handleChange.bind(a),a.handleKeyUp=a.handleKeyUp.bind(a),a.addTag=a.addTag.bind(a),a.deleteTag=a.deleteTag.bind(a),a.searchTags=a.searchTags.bind(a),a.closeSearch=a.closeSearch.bind(a),a}return h()(t,e),d()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.id;(0,t.getTicketTags)(a).then(function(t){var a=t.data;e.setState({tagsList:a.res.tags})})}},{key:"handleChange",value:function(e){this.setState({name:e}),e.length>2?this.searchTags(e,1):this.closeSearch()}},{key:"handleKeyUp",value:function(e){var t=e.keyCode,a=this.state,n=a.name,s=a.searchList,o=a.selectSearchIndex;13==t?o>-1?this.addTag(s[o]):n.length>=3&&-1==n.indexOf(",")&&this.addTag({name:n}):188==t?n.length>3&&(n=n.substring(0,n.indexOf(",")),this.addTag({name:n})):40==t?this.setState(function(e){var t=e.selectSearchIndex==s.length-1?0:e.selectSearchIndex+1;return{selectSearchIndex:t,name:s[t].name}}):38==t?this.setState(function(e){var t=e.selectSearchIndex<=0?s.length-1:e.selectSearchIndex-1;return{selectSearchIndex:t,name:s[t].name}}):27==t&&this.closeSearch()}},{key:"addTag",value:function(e){var t=this,a=e.name;if(10==this.state.tagsList.length)this.setState({showErrorMsg:!0});else{var n=this.props,s=n.id;(0,n.associateTag)(s,a).then(function(e){var a=t.state.tagsList;a=a.concat(e.data.data),t.closeSearch(),t.setState({name:"",tagsList:a})},function(){t.setState({name:""})})}}},{key:"deleteTag",value:function(e){var t=this,a=this.props,n=a.id;(0,a.dissociateTag)(n,e).then(function(){var a=t.state.tagsList.filter(function(t){return t.name!=e});t.setState({tagsList:a,showErrorMsg:!1})})}},{key:"isContainsSpecialCharacters",value:function(e){return/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(e)}},{key:"searchTags",value:function(e,t){var a=this;if(!this.isContainsSpecialCharacters(e)){var n=this.props.getTagSearchList,o=this.state,l=o.limit,r=o.searchName,i=o.tagsList;return t=1===t?t:this.state.from+l,n(e=(e=e||r).toLowerCase(),t,l).then(function(n){var s=n.data.res.data,o=s.length<l,r=[];(s=1==t?s:a.state.searchList.concat(s)).length&&(r=s.filter(function(e){return!i.filter(function(t){return t.name==e.name}).length}));var c=r.find(function(t){return t.name===e});c=c||i.find(function(t){return t.name===e}),s.length&&r.length&&c||r.push({name:e,isNew:!0,newLabel:k.h.getI18NValue("support.label.newtag")}),a.setState({searchList:r,noMoreData:o,searchName:e})},function(){var t=[{name:e,isNew:!0,newLabel:k.h.getI18NValue("support.label.newtag")}];a.setState({searchList:t,noMoreData:!0,searchName:e})})}return new s.a(function(t){var n=[{name:e,isNew:!0,newLabel:k.h.getI18NValue("support.label.newtag")}];a.setState({searchList:n,noMoreData:!0,searchName:e}),t()})}},{key:"closeSearch",value:function(){this.setState({searchList:[],selectSearchIndex:-1})}},{key:"render",value:function(){var e=this.props,t=e.toggleTags,a=e.isReadOnly,n=e.isActive,s=this.state,o=s.tagsList,l=s.name,r=s.searchList,i=s.selectSearchIndex,c=s.noMoreData,d=s.showErrorMsg;return f.a.createElement(w,{isActive:n,name:l,handleKeyUp:this.handleKeyUp,handleChange:this.handleChange,closeSearch:this.closeSearch,searchList:r,selectSearchIndex:i,addTag:this.addTag,searchTags:this.searchTags,noMoreData:c,showErrorMsg:d,tagsList:o,toggleTags:t,deleteTag:this.deleteTag,isReadOnly:a})}}]),t}(g.Component);D.propTypes={getTagSearchList:v.a.func,getTicketTags:v.a.func,id:v.a.string,isActive:v.a.bool,isReadOnly:v.a.bool,toggleTags:v.a.func};t.default=Object(T.connect)(function(e){return{}},{getTicketTags:L.g,associateTag:L.a,dissociateTag:L.b,getTagSearchList:L.e})(D)}}]);