(window.deskappJsonp=window.deskappJsonp||[]).push([[61],{"./src/components/AttachmentViewer/AttachmentViewer.js":function(e,t,n){"use strict";n.r(t);var a=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),r=n.n(a),o=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/createClass.js"),c=n.n(s),l=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=n.n(l),d=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/inherits.js"),u=n.n(d),p=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js"),h=n.n(p),f=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/prop-types/index.js"),v=n.n(f),g=n("../components/lib/Layout/index.js"),w=n("./src/components/AttachmentViewer/AttachmentViewer.module.css"),b=n.n(w),x=n("./src/components/Link/Link.js"),I=n("./node_modules/@zohodesk/icons/lib/Icon/index.js"),z=n.n(I),y=n("./src/utils/Attachment.js"),N=n("./src/components/Image/Image.js"),k=function(e){function t(e){i()(this,t);var n=m()(this,(t.__proto__||r()(t)).call(this,e));return n.state={isPViewListOpen:!0,selectedIndex:n.props.previewObj.selectedIndex,isZoomed:!1},n.togglePViewList=n.togglePViewList.bind(n),n.changeSelectedIndex=n.changeSelectedIndex.bind(n),n.closeAttachmentViewer=n.closeAttachmentViewer.bind(n),n.toogleZoom=n.toogleZoom.bind(n),n}return u()(t,e),c()(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.setState({isPViewListOpen:!1})},3e3)}},{key:"togglePViewList",value:function(){var e=this;this.setState(function(e){return{isPViewListOpen:!e.isPViewListOpen}},function(){e.focusSelectedImg(e.state.selectedIndex)})}},{key:"toogleZoom",value:function(){this.setState(function(e){return{isZoomed:!e.isZoomed}})}},{key:"constructImgURL",value:function(e){return e+"?orgId="+this.props.orgId+"&inline=true"}},{key:"changeSelectedIndex",value:function(e){var t=this;this.setState({selectedIndex:e},function(){t.focusSelectedImg(e)})}},{key:"focusSelectedImg",value:function(e){var t=this["img_"+e];if(t){var n=this.imgListCont;t.offsetLeft;n.scrollLeft=t.offsetLeft}}},{key:"handleKeyUp",value:function(e){if(27==e.keyCode)this.closeAttachmentViewer();else if(37==e.keyCode){var t=this.state.selectedIndex;0!=t&&this.changeSelectedIndex(t-1)}else if(39==e.keyCode){var n=this.state.selectedIndex;n!=this.props.previewObj.previewData.length-1&&this.changeSelectedIndex(n+1)}}},{key:"closeAttachmentViewer",value:function(){this.setState({isPViewListOpen:!1,isZoomed:!1}),this.props.hideAttachmentViewer()}},{key:"componentWillMount",value:function(){window.addEventListener("keyup",this.handleKeyUp.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keyup",this.handleKeyUp.bind(this))}},{key:"render",value:function(){var e=this,t=this.props.previewObj.previewData||[],n=this.state,a=n.isPViewListOpen,r=n.selectedIndex,o=n.isZoomed,i=t.length,s=t[r]||{},c=s.viewUrl?s.viewUrl:this.constructImgURL(s.href),l=Object(y.i)(s.name),m="audio/"+Object(y.e)(s.name);return h.a.createElement(g.Container,{scroll:"none"},h.a.createElement(g.Box,null,h.a.createElement(g.Container,{alignBox:"row",className:b.a.header},h.a.createElement(g.Box,{flexible:!0,className:b.a.title,"data-title":s.name},s.name),h.a.createElement(g.Box,{flexible:!0,className:b.a.count},r+1,"/",i),h.a.createElement(g.Box,{flexible:!0,className:b.a.menuBar},h.a.createElement(g.Container,{isInline:!0,tagName:"span",alignBox:"row",wrap:"wrap",className:b.a.menuGroup},o?h.a.createElement("div",{className:b.a.menu,onClick:this.toogleZoom},h.a.createElement(z.a,{name:"ZD-zoomOut",iconClass:b.a.zoomIcon})):h.a.createElement("div",{className:b.a.menu,onClick:this.toogleZoom},h.a.createElement(z.a,{name:"ZD-zoomIn",iconClass:b.a.zommIcon})),h.a.createElement(x.a,{className:b.a.menu,href:c,target:"_blank"},h.a.createElement(z.a,{name:"ZD-newtab",isBold:!0,iconClass:b.a.newTabIcon})),h.a.createElement(x.a,{className:b.a.menu,href:c,download:!0},h.a.createElement(z.a,{name:"ZD-inbox",iconClass:b.a.zoomIcon})),h.a.createElement("div",{className:b.a.menu,onClick:this.closeAttachmentViewer},h.a.createElement(z.a,{name:"ZD-inappClose",iconClass:b.a.appIcon})))))),h.a.createElement(g.Box,{flexible:!0},h.a.createElement(g.Container,{alignBox:"row"},h.a.createElement(g.Box,{className:b.a.arrowBox+" "+(0==r?b.a.hidden:""),onClick:this.changeSelectedIndex.bind(this,r-1)},h.a.createElement(z.a,{name:"ZD-arrowLeft3",iconClass:b.a.arrow})),h.a.createElement(g.Box,{flexible:!0,className:b.a.preview,scroll:"both"},l?h.a.createElement("video",{autoPlay:!0,controls:!0,className:b.a.zoomIn},h.a.createElement("source",{src:c,type:m})):h.a.createElement(N.a,{className:o?b.a.zoomOut:b.a.zoomIn,src:c,onClick:this.toogleZoom,alt:"Preview"})),h.a.createElement(g.Box,{className:b.a.arrowBox+" "+(i==r+1?b.a.hidden:""),onClick:this.changeSelectedIndex.bind(this,r+1)},h.a.createElement(z.a,{name:"ZD-arrowRight3",iconClass:b.a.arrow})))),1!=i&&h.a.createElement("span",{className:b.a.button,onClick:this.togglePViewList},a?h.a.createElement("span",{className:b.a.downArrow},h.a.createElement(z.a,{name:"ZD-arrow1",iconClass:b.a.pullDownIcon})):h.a.createElement(z.a,{name:"ZD-pullDown",iconClass:b.a.pullDownIcon})),h.a.createElement(g.Box,{className:"\n              "+(a&&1!=i?b.a.footerActive:"")+" "+b.a.footer+" "},h.a.createElement("div",{className:b.a.listContainer},h.a.createElement(g.Container,{alignBox:"row",scroll:"horizontal",tagName:"ul",className:b.a.imgList,eleRef:function(t){return e.imgListCont=t}},t.map(function(t,n){var a=t.name,o=t.viewUrl,i=t.href,s=Object(y.i)(a);return h.a.createElement("li",{className:b.a.imgItem+" "+(n==r?b.a.selected:"")+"  "+(s?b.a.isAudio:""),key:n,onClick:e.changeSelectedIndex.bind(e,n),ref:function(t){return e["img_"+n]=t}},h.a.createElement(N.a,{src:o||e.constructImgURL(i),alt:"Attachment",className:b.a.image}))})))))}}]),t}(p.Component);t.default=k,k.propTypes={hideAttachmentViewer:v.a.func,orgId:v.a.string,previewObj:v.a.object}},"./src/components/AttachmentViewer/AttachmentViewer.module.css":function(e,t,n){e.exports={header:"zd-attachmentviewer-header zd934260ce09",title:"zd-attachmentviewer-title zdbce71b4599 zdccf2edd024 zd6063afa107",count:"zd-attachmentviewer-count",menuBar:"zd-attachmentviewer-menuBar",menu:"zd-attachmentviewer-menu",menuGroup:"zd-attachmentviewer-menuGroup zd391bc5a95f",arrowBox:"zd-attachmentviewer-arrowBox zd5a44b500ed",arrow:"zd-attachmentviewer-arrow",preview:"zd-attachmentviewer-preview",zoomIn:"zd-attachmentviewer-zoomIn zdddbd5cdbee zd79a1f950cf",zoomOut:"zd-attachmentviewer-zoomOut",button:"zd-attachmentviewer-button",visible:"zd-attachmentviewer-visible",hidden:"zd-attachmentviewer-hidden",footer:"zd-attachmentviewer-footer",footerActive:"zd-attachmentviewer-footerActive",listContainer:"zd-attachmentviewer-listContainer",imgList:"zd-attachmentviewer-imgList",imgItem:"zd-attachmentviewer-imgItem",image:"zd-attachmentviewer-image",selected:"zd-attachmentviewer-selected",downArrow:"zd-attachmentviewer-downArrow",mymove:"zd-attachmentviewer-mymove",zoomIcon:"zd-attachmentviewer-zoomIcon",newTabIcon:"zd-attachmentviewer-newTabIcon",appIcon:"zd-attachmentviewer-appIcon",pullDownIcon:"zd-attachmentviewer-pullDownIcon",isAudio:"zd-attachmentviewer-isAudio zd1065d8f45f",video:"zd-attachmentviewer-video"}},"./src/components/Image/Image.js":function(e,t,n){"use strict";var a=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),r=n.n(a),o=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/createClass.js"),c=n.n(s),l=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=n.n(l),d=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/inherits.js"),u=n.n(d),p=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js"),h=n.n(p),f=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/prop-types/index.js"),v=n.n(f),g=n("./src/components/Image/Image.module.css"),w=n.n(g),b=function(e){function t(){return i()(this,t),m()(this,(t.__proto__||r()(t)).apply(this,arguments))}return u()(t,e),c()(t,[{key:"render",value:function(){var e=this.props,t=e.alt,n=e.src,a=e.className,r=e.isCover,o=e.title,i=e.onClick,s=e.dataId;return h.a.createElement("img",{src:n,alt:t,"data-title":o,"data-id":s,className:" "+a+" "+(r?w.a.imgFullSize:w.a.imgMaxFullSize)+" ",onClick:i})}}]),t}(h.a.Component);t.a=b,b.propTypes={alt:v.a.string.isRequired,className:v.a.string,dataId:v.a.string,isCover:v.a.bool,onClick:v.a.func,src:v.a.string.isRequired,title:v.a.string},b.defaultProps={isCover:!1,className:""}},"./src/utils/Attachment.js":function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"f",function(){return c}),n.d(t,"e",function(){return l}),n.d(t,"l",function(){return m}),n.d(t,"i",function(){return d}),n.d(t,"p",function(){return u}),n.d(t,"q",function(){return p}),n.d(t,"m",function(){return h}),n.d(t,"k",function(){return f}),n.d(t,"h",function(){return g}),n.d(t,"j",function(){return w}),n.d(t,"b",function(){return b}),n.d(t,"a",function(){return x}),n.d(t,"n",function(){return I}),n.d(t,"c",function(){return z}),n.d(t,"o",function(){return y}),n.d(t,"g",function(){return N});var a=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/promise.js"),r=n.n(a),o=n("./src/utils/Browser.js"),i=n("./src/fz-i18n/index.js");function s(e){var t=l(e),n=Object(o.a)().toLowerCase()||"",a=navigator.platform.toLowerCase()||"";switch(t){case"jpeg":case"jpg":case"png":case"gif":case"bmp":case"tiff":case"tif":case"ico":return"ZD-filePicture";case"txt":case"rtf":return"ZD-fileText2";case"pdf":return"ZD-filePdf";case"html":case"htm":case"xhtml":return-1!==n.indexOf("chrome")||-1!==n.indexOf("safari")?"ZD-chrome":-1!==n.indexOf("ie")||-1!==n.indexOf("edge")?"ZD-ie":"ZD-firefox";case"ppt":case"pps":case"odp":case"sxi":case"pptx":return"ZD-ppt";case"rar":case"jar":case"zip":return"ZD-zip3";case"doc":case"docx":case"sxw":case"odt":return-1!==a.indexOf("mac")||-1!==a.indexOf("linux")?"ZD-fileOpenoffice":"ZD-fileWord";case"xml":return"ZD-xml";case"xls":case"xlsx":case"sxc":case"ods":case"csv":case"tsv":return"ZD-fileExcel";case"ics":return"ZD-ics";case"exe":return"ZD-exe";case"sh":case"bin":return"ZD-sh2";case"css":return"ZD-css5";case"mp3":case"wav":case"wma":case"aac":case"m4r":case"ogg":return"ZD-fileMusic";case"mp4":case"mkv":case"mov":case"mpeg":case"flv":case"avi":case"webm":return"ZD-fileVideo";default:return"ZD-unknown"}}function c(e){return(e=parseInt(e))<1e3?e+" Bytes":e<1e6?(e/1e3).toFixed(1)+" KB":e>=1e6?(e/1e6).toFixed(1)+" MB":void 0}function l(e){return e&&-1!=e.indexOf(".")?e.substring(e.lastIndexOf(".")+1,e.length).toLowerCase():""}function m(e){var t=l(e);return/jpeg|jpg|png|gif|bmp|ico/i.test(t)}function d(e){var t=l(e);return/mp3|wav|ogg/i.test(t)}function u(e,t){var n={inValidArray:[],validArray:[]};if(t+e.length>10)return n.isCountExceeds=!0,n;for(var a=0;a<e.length;a++){var r=e[a],o=r.name,i=r.size;h(o)?n.inValidArray.push({isUnSupported:!0}):f(o)?n.inValidArray.push({isFileNameSizeInvalid:!0}):0===r.size?n.inValidArray.push({isEmpty:!0}):v(i)?n.inValidArray.push({isAttachSizeExceeded:!0}):n.validArray.push(r)}return n}function p(e,t,n,a){if(t+e.length>10)a(i.h.getI18NValue("support.attachments.count.exceeds",[10]));else for(var r=0;r<e.length;r++){var o=e[r],s=o.name,c=o.size;if(h(s))a(i.h.getI18NValue("support.community.attachmentcontent.extensionnotpermitted"));else if(f(s))a(i.h.getI18NValue("support.comments.attachment.fileNameSizeLimitation"));else if(0!==o.size)if(v(c))a(i.h.getI18NValue("support.feedback.uploaded.file.exceeds.20mb"));else{var l=new FormData;l.append("file",o),n&&n(l)}else a(i.h.getI18NValue("support.request.empty.attachment.message"))}}function h(e){var t=e.split(".").pop().toLowerCase();return-1!==["ade","adp","bat","chm","cmd","com","cpl","exe","hta","ins","isp","jar","lib","lnk","mde","msc","msp","mst","pif","scr","sct","shb","sys","vb","vbe","vxd","wsc","wsf","wsh","jse","vbs"].indexOf(t)}function f(e){return e.length>100}function v(e){return e>20971520}function g(e){var t=0;return e.forEach(function(e){t+=parseInt(e.size)}),t}function w(e,t){return!(!(null!==e.types||e.files&&e.files.length>0)||t.fromPaste||!(e.files&&e.files.length>0||(e.types.indexOf?-1!==e.types.indexOf("Files"):e.types.contains("application/x-moz-file"))||"Files"===e.types[0]))}function b(e,t,n){var a={};a.previewData=t.filter(function(e){return!e.isPreview&&(m(e.name)||d(e.name))}),a.previewData.filter(function(t,n){t.id===e&&(a.selectedIndex=n)}),n&&n(a)}function x(e,t,n){var a=e.indexOf("/api"),r=e;return a>-1&&(r=e.slice(a,e.length),r+="?orgId="+t+(n?"&inline=true":"")),r}function I(e,t){window.open(x(e,t,!0))}function z(e,t){window.location.href=x(e,t,!1)}function y(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=e.length,l=[],m=[],d=0;if(a&&c>a-n){var u=i.h.getI18NValue("support.attachments.count.exceeds",[a]);return r.a.resolve({isError:!0,errorI18N:u})}for(var p=0;p<c;p++){var v=e[p],g=v||{},w=g.size,b=void 0===w?0:w,x=g.name,I=void 0===x?"":x;if(d+=b,h(I)){var z=i.h.getI18NValue("support.community.attachmentcontent.extensionnotpermitted");l.push({errorI18N:z,fileName:I,errorType:"fileType"})}else if(f(I)){var y=i.h.getI18NValue("support.comments.attachment.fileNameSizeLimitation");l.push({errorI18N:y,fileName:I,errorType:"fileNameSize"})}else if(0===b){var N=i.h.getI18NValue("support.request.empty.attachment.message");l.push({errorI18N:N,fileName:I,errorType:"emptyFile"})}else m.push(v)}if(!m.length){if(1===l.length){var k=l[0].errorI18N;return r.a.resolve({isError:!0,errorI18N:k})}var C=i.h.getI18NValue("support.unable.to.process.your.request");return r.a.resolve({isError:!0,errorI18N:C})}if(0===d){var E=i.h.getI18NValue("support.request.empty.attachment.message");return r.a.resolve({isError:!0,errorI18N:E})}if(d+s>1024*o*1024){var j=i.h.getI18NValue("support.attachments.size.limit.exceeds",[o]);return r.a.resolve({isError:!0,errorI18N:j})}for(var V=[],_=[],D=[],Z=[],L=function(e){var n=m[e];if(t){var a=new FormData;a.append("file",n);var r=e,o=t(a,n,r).then(function(e){var t=(e.data||{}).data,n=void 0===t?{}:t,a=n.id;a&&(V[r]=n,_[r]=a)},function(t){var a=n.name,r=i.h.getI18NValue("support.unable.to.process.your.request");return Z.push(e),l.push({errorI18N:r,fileName:a,errorType:"apiError"}),t});D.push(o)}},A=0;A<m.length;A++)L(A);var O={uploadFiles:V,inValidFiles:l,isError:!1,uploadFileIds:_,inValidFilesIndex:Z};return r.a.all(D).then(function(){return _.length?O:{isError:!0,errorI18N:i.h.getI18NValue("support.unable.to.process.your.request")}})}function N(e,t){var n=e.name;return{index:t,isPreview:!0,size:e.size,name:n,href:URL.createObjectURL(e)}}}}]);