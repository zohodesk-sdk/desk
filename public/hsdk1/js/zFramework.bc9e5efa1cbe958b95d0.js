(window.deskappJsonp=window.deskappJsonp||[]).push([[174],{"./src/marketplace/ZFramework.js":function(e,t,n){"use strict";n.r(t);var o=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/promise.js"),i=n.n(o),r=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/typeof.js"),a=n.n(r),s=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/keys.js"),c=n.n(s),d=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/create.js"),u=n.n(d),f=function(e){var t=void 0;function n(){}function o(e){this.name="AuthenticationError",this.message=e,this.stack=(new Error).stack}return n.prototype.Info=function(){(e.isDevMode()||e.isLogEnabled())&&console.info.apply(console,arguments)},n.prototype.Error=function(){console.log.apply(console,arguments),console.error(new Error)},o.prototype=u()(Error.prototype),o.prototype.constructor=o,e.getPatchedString=function(e,t){var n={};if(!e||"string"!=typeof e)throw new Error("Invalid String");return Array.isArray(t)?t.forEach(function(e){n[e.name]=e.value}):n=t,e.replace(/\$\{\w{1,}\}/g,function(e){var t=e.replace(/[${}]/g,"");return n[t]})},e.getURLOrigin=function(e){var t=e||document.location.href,n=document.createElement("a");return n.setAttribute("href",t),n.protocol+"//"+n.host},e.getQueryParams=function(e){var t={},n=e||window.location.href,o=document.createElement("a");o.setAttribute("href",n);var i="string"==typeof o.search?o.search.substr(1):n.substr(n.indexOf("?")+1);return(i.length>1?i.split("&"):[]).forEach(function(e){var n=e.split("=");t[n[0]]=n[1]}),t},e.isURL=function(e){return-1!==e.indexOf("http")},e.isDevMode=function(){return localStorage&&!!localStorage.getItem("isDevMode")},e.isLogEnabled=function(){return localStorage&&!!localStorage.getItem("isLogEnabled")},e.getLogger=function(){return t&&t instanceof n||(t=new n),t},e.constructQueryParamsString=function(e){var t=[];for(var n in e)n&&e[n]&&t.push(n+"="+e[n]);return t.join("&")},e.AuthenticationError=o,e}(window.ZAppUtil||{});function l(e){this.__WIDGET__=e,this._hasLoaded=!1,this._isActive=!1,this._bindedEvents={},this._hasRegistered=!1,this._origin,this._type}l.prototype.getWidgetInfo=function(){return{url:this.getURL(),location:this.getLocation(),widgetID:this.getUniqueID(),name:this.getProp("name")}},l.prototype.hasLoaded=function(){return!!this._hasLoaded},l.prototype.isActive=function(){return this._isActive},l.prototype.getOrigin=function(){return this._origin},l.prototype.activate=function(e){return this._isActive=!0,this._isActive},l.prototype.deActivate=function(e){return this._isActive=!1,this._isActive},l.prototype.getConfig=function(){return this.__WIDGET__&&this.__WIDGET__.config},l.prototype.getURL=function(){return this.__WIDGET__.url},l.prototype.getLocation=function(){return this.__WIDGET__.location},l.prototype.getExtensionID=function(){return this.__WIDGET__&&this.__WIDGET__.extension_id},l.prototype.getExtensionVersion=function(){return this.__WIDGET__&&this.__WIDGET__.extension_version},l.prototype.getZAppID=function(){return this.__WIDGET__&&this.__WIDGET__.zappid},l.prototype.getResolvedURL=function(){return this._resolvedURL},l.prototype.getUniqueID=function(){return this._uniqueID},l.prototype.getProp=function(e){return this.__WIDGET__&&this.__WIDGET__[e]},l.prototype.getIFrame=function(){return document.getElementById(this._uniqueID)},l.prototype.getWindow=function(){var e=document.getElementById(this._uniqueID);return e&&e.contentWindow},l.prototype.SendEvent=function(e,t,n){var o,i={type:"__EVENT__",data:t,uniqueID:this.getUniqueID(),widgetID:this.getUniqueID(),eventName:e,isPromise:n},r=this._bindedEvents[e],a=[];if(void 0!==r)for(var s in r)r.hasOwnProperty(s)&&(o=v.GetWidgetInstance(s))&&o.isActive()&&(n?a.push(p.SendMessage(o,i)):p.SendMessage(o,i));if(n)return a},l.prototype.addEventInfo=function(){},l.prototype.removeEventInfo=function(){},l.prototype.getEvents=function(){return c()(this._bindedEvents)};var p=function(e){var t,n=f.getLogger(),o=100,r={};function s(e,t){var a,s=t.isPromise;s&&(a="Promise"+o++,t.promiseID=a);var c,d=E(e.getResolvedURL()),u=e.getWindow();if(u&&d)return t.__time__=(new Date).getTime(),u.postMessage(t,d),s?(c=a,new i.a(function(e,t){r[c]={resolve:e,reject:t,time:(new Date).getTime()}})):void 0;n.Error("Invalid IFrame object. Can't send Message to Widget")}function d(e,t){e||n.Info("Invalid WidgetInstance passed"),e._hasLoaded=!0,e.activate(),s(e,t),"__MODAL__"===e.getLocation()&&setTimeout(function(){e.SendEvent("modal.opened")},0),"function"==typeof e.getProp("onload")&&setTimeout(e.getProp("onload").bind(null,[e.getConfig()]),e.AppOnLoadDelay||0)}function u(e,n){var o=n.uniqueID,i=v.GetWidgetInstance(o),r={extension_id:i.getExtensionID(),extension_version:i.getExtensionVersion()};for(var a in n.options)n.options.hasOwnProperty(a)&&(r[a]=n.options[a]);var c={type:"__EVENT_RESPONSE__",eventName:"__INVOKE_MODAL__",promiseID:n.promiseID,time:(new Date).getTime()};try{var d=new l(r);t.RenderWidget(r.location,d),c.isSuccess=!0,c.data=d.getWidgetInfo()}catch(e){c.isSuccess=!1,c.data=e.message}s(i,c)}function p(e,t){var o=t.uniqueID,i=v.GetWidgetInstance(o),r=i.getExtensionID(),a=[],c={type:"__EVENT_RESPONSE__",eventName:"__WIDGETS_INFO__",promiseID:t.promiseID,time:(new Date).getTime()};try{var d=v.GetAllWidgetInstance();for(var u in d)if(d.hasOwnProperty(u)){var f=d[u];f&&f.getUniqueID()!==o&&f.getExtensionID()===r&&f.isActive()&&a.push(f.getWidgetInfo())}c.isSuccess=!0,c.data=a}catch(e){n.Error(e.message),c.isSuccess=!1}s(i,c)}function g(e,t,n,o,i){s(e,{type:"__EVENT_RESPONSE__",eventName:"eventName",promiseID:t,time:(new Date).getTime(),data:i,isSuccess:o})}function _(e,n){var o=n.options,i=n.promiseID,r=n.uniqueID,a={resolve:h.bind(null,r,e.origin,i,!0),reject:h.bind(null,r,e.origin,i,!1)};t.ProcessGetRequest(i,r,o,a)}function h(e,t,n,o,i){var r=v.GetWidgetInstance(e).getWindow(),a={type:"__EVENT_RESPONSE__",eventName:"__HTTP__",data:i,time:(new Date).getTime(),promiseID:n,isSuccess:o};setTimeout(function(){r.postMessage(a,t)},0)}function E(e){var t=document.createElement("a");return t.setAttribute("href",e),t.protocol+"//"+t.host+t.pathname}return e.Init=function(o,i){if(!o||"object"!==(void 0===o?"undefined":a()(o)))throw Error("Invalid Context object passed");if(i&&"object"!==(void 0===i?"undefined":a()(i)))throw Error("Invalid Configuration Passed to MessageHandler");return t=o,function(e){var o;try{o="string"==typeof e.data?JSON.parse(e.data):e.data}catch(t){o=e.data}var i=o.type;try{if(-1!==["__REGISTER__","__DEREGISTER__"].indexOf(i)||function(e,n){var o=t.GetWidgetInstance(n.uniqueID),i=o&&o.getWindow();if("string"!=typeof n.uniqueID&&!i)throw new f.AuthenticationError("Message from Invalid window from received");var r=E(o.getResolvedURL()),a=o.getUniqueID(),s=e.source,c=n.uniqueID,d=E(decodeURIComponent(n.widgetOrigin));if(i!==s||r!==d||a!==c)throw new Error("Message from UnAuthorized Source");return!0}(e,o))switch(i){case"__REGISTER__":!function(e,o){var i=e.source,r=e.origin,a=o.uniqueID,s=t.GetWidgetInstance(a);!s||s&&i!==s.getWindow()?n.Error("Message from Invalid IFrame arrived."):(s._origin=r,s._isActive=!0,s._hasRegistered=!0)}(e,o);break;case"__DEREGISTER__":!function(e,n){t.DeleteWidgetInstance(n.uniqueID)}(0,o);break;case"__EVENT_BIND__":!function(e,t){var n=t.uniqueID,o=t.widgetID,i=t.eventName,r=v.GetWidgetInstance(o);r&&!r._bindedEvents[i]&&(r._bindedEvents[i]={}),r._bindedEvents[i][n]=t.count}(0,o);break;case"__EMIT__":!function(e,t){var n=t.widgetID,o=t.eventName,i={widgetID:n,data:t.data,eventName:o,type:"__EMIT__"},r=v.GetWidgetInstance(n),a=r._bindedEvents[o]&&c()(r._bindedEvents[o]);Array.isArray(a)&&a.forEach(function(e){var t=v.GetWidgetInstance(e);t&&t.isActive()&&s(t,i)})}(0,o);break;case"__EVENT_RESPONSE__":!function(e,t){var n=t.promiseID,o=t.data;r.hasOwnProperty(n)&&(r[n].resolve(o),r[n]=void 0,delete r[n])}(0,o);break;default:!function(e,o){var i={__HTTP__:_,__WIDGETS_INFO__:p,__CREATE_INSTANCE__:u}[o.eventName];i?i(e,o):function(e,o){var i=o.eventName,r=o.promiseID,a=o.data,s=o.uniqueID,c=t.GetWidgetInstance(s),d=c.getConfig(),u=c.getExtensionID();n.Info("Event from SDK => Eventname : ",i,", Time : ",o.time,", Eventpayload : ",a);var f={data:a,config:d,iframe:c.getIFrame()};if(r){var l={resolve:g.bind(null,c,r,i,!0),reject:g.bind(null,c,r,i,!1)};f.promise=l}void 0!==u&&(f.extension_id=u,f.widgetID=s),t.TriggerEventListeners(i,f)}(0,o)}(e,o)}}catch(e){e instanceof f.AuthenticationError||n.Error("[MessageHandler] => ",e.stack)}}.bind(e)},e.SendMessage=s,e.BroadcastEvent=function(e,n,o){var r,a=t.GetAllWidgetInstance(),s=[];for(var c in a)if(a.hasOwnProperty(c)&&(r=a[c])&&r.isActive()){var d=r.SendEvent(e,n,o);if(o&&d)for(var u=0;u<d.length;u++)s.push(d[u])}return o?s:i.a.resolve()},e.WidgetLoadHandler=function(e){var o=e.getIFrame()&&e.getIFrame().getAttribute("data-location"),i=t.GetMeta(o),r=e.getExtensionID(),a={type:"__REGISTER__",uniqueID:e.getUniqueID(),data:{meta:i,uniqueID:e.getUniqueID(),extensionID:r,location:e.getLocation()}};t.FetchLocaleResource(r).then(function(t){void 0!==t&&(a.data.locale=t.locale,a.data.localeResource=t.content),d(e,a)}).catch(function(t){n.Info("Error occured while fetching I18NResource ",t),d(e,a)})},e}(window.MessageManager||{}),g=function(e){return e.WidgetHandler=function(e){var t,n=e.location,o=e.resolvedURL;return n&&"string"==typeof n&&(n=t=document.getElementById(n)),n instanceof HTMLIFrameElement&&(t=n).setAttribute("src",o),t},e}(window.DefaultRenderHandlers||{}),v=function(e){var t=f.getLogger();try{var n=function(e){return J[e]},o=function(e){return F[e]},r=function(){return F},s=function(e){return B[e]},c=function(e,t){var n=document.getElementById(e);t?(F[e]=void 0,delete F[e],n&&n.parentElement.removeChild(n)):n||(F[e]=void 0,delete F[e])},d=function(e,n){try{var o=G();n._uniqueID=o,n._resolvedURL=E(n),h(N,n);var i=q.WidgetHandler(e,n);if(i instanceof HTMLIFrameElement){i.setAttribute("data-location",e),i.setAttribute("id",o),F[o]=n;var r=document.getElementById(o);null!==r&&r.addEventListener("DOMNodeRemovedFromDocument",function(){F[o]=void 0,delete F[o]}),i.onload=p.WidgetLoadHandler.bind(null,n),u(o),h(M,n)}else t.Info("[windowRef] is not an IFrameElement."+e+" , "+n.getURL())}catch(e){throw e}return n},u=function(e){setTimeout(function(){var t=F[e];t&&t._hasLoaded&&!t._hasRegistered&&(F[e]=void 0,delete F[e])},S)},_=function(){return z},h=function(e,t){if(e&&"function"==typeof e)return e(t)},E=function(e){var t,n=e.getURL(),o=f.getURLOrigin(),i={serviceOrigin:encodeURIComponent(o),isDevMode:_(),isLogEnabled:f.isLogEnabled()},r=f.constructQueryParamsString(i);if(f.isURL(n))t=n;else{var a=e.getExtensionID();t=m(a)+n}var s=t.indexOf("?");if(-1===s){var c=t.indexOf("#");-1===c?t+="?"+r:t=t.slice(0,c)+"?"+r+t.slice(c)}else s+=1,t=t.slice(0,s)+r+"&"+t.slice(s);return t},I=function(e,t){var n={};if(!e||"string"!=typeof e)throw new Error("Invalid String");return Array.isArray(t)?t.forEach(function(e){n[e.name]=e.value}):n=t,e.replace(/\{\{\w{1,}\}\}/g,function(e){var t=e.replace(/[{{}}]/g,"");return n[t]})},m=function(e){return function(e){e.zappid&&e.zappid.indexOf("-")>-1?k.zappsHost.path="/appfiles/v2/{{zappid}}/{{version}}/{{hashkey}}":k.zappsHost.path="/appfiles/{{zappid}}/{{version}}/{{hashkey}}";var t=k.zappsHost;return _()&&(t=k.devHost),(t.protocol?t.protocol:window.location.protocol)+"//"+I(t.host,e)+(t.port?":"+t.port:"")+(t.path&&I(t.path,e))}("string"==typeof e?s(e):e)},y=function(e){try{var n="string"==typeof e?JSON.parse(e):e;if("object"!==(void 0===n?"undefined":a()(n)))return void t.Error("Invalid extension config passed");var o=n.modules;void 0===o&&t.Error("Invalid modules properties"),D(n,o.widgets),w(n,n.connectors),n.config=x(n.config),n.modules.widgets=void 0,n.connectors=void 0,n.modules=void 0,delete n.modules,delete n.connectors,B[n.id]=n}catch(e){t.Error("Error in Loading App Data ",e)}},D=function(e,t){if(Array.isArray(t))for(var n=0,o=t.length;n<o;n++)t[n].extension_id=e.id,t[n].extension_version=e.version,C.push(t[n])},w=function(e,t){if(Array.isArray(t)){for(var n=0,o=t.length;n<o;n++)t[n].extension_id=e.id,t[n].extension_version=e.version;V=V.concat(t)}},x=function(e){return _()?e:Array.isArray(e)?e.filter(function(e){return!Boolean(e.secure)}):void 0},R=function(e){return H[e]},b=function(e,t){return e.filter(function(e){return!(e.extension_id===t)})},A=function(e,n,o,i){try{if(t.Info("ProcessGetRequest : PromiseID: ",e,", Options: ",o),o.contentType=o&&o.contentType?o.contentType:"application/text",o.dataType=o&&o.dataType?o.dataType:"text",o.widgetID=n,"function"!=typeof U)throw new Error("Provide Request handler implementation in the Bootstrap.");U(o,i)}catch(e){t.Error("ProcessGetRequest : Error => ",e)}},L=function(e,t){var n=Q[e];if(Array.isArray(n))for(var o=0;o<n.length;o++)n[o](t)},T=function(e){return new i.a(function(t,n){var o=B[e];if(o&&void 0===o.locale)n();else if(o&&void 0!==o.localeResource)t({locale:o.locale,content:o.localeResource});else{var i=o.locale,r=m(e)+"/app/translations/"+i+".json";W(r,i).then(function(e){t(e)}).catch(function(){i!==P?(r=m(e)+"/app/translations/"+P+".json",W(r,P).then(function(e){t(e)}).catch(function(e){n(e)})):n()})}})},W=function(e,t){return new i.a(function(n,o){try{var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE&&200===i.status){var e;try{e=JSON.parse(i.responseText)}catch(e){o(e)}n({locale:t,content:e})}else i.readyState===XMLHttpRequest.DONE&&o(i.status)},i.open("GET",e),i.send()}catch(e){o()}})},G=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},S=15e3,O="com";window.location.origin.endsWith(".eu")?O="eu":window.location.origin.endsWith(".in")?O="in":window.location.origin.endsWith(".cn")&&(O="cn");var N,M,P,q,U,j=!1,z=!1,H={},k={devHost:{host:"127.0.0.1",port:"5000",path:""},zappsHost:{host:"{{zappid}}.zappsusercontent."+O,port:"",path:"/appfiles/{{zappid}}/{{version}}/{{hashkey}}"}},B={},C=[],F={},V=[],J={},Z={},Q={};return e.Bootstrap=function(u){return new i.a(function(i,f){var l,v,h;try{if(!u||"object"!==(void 0===u?"undefined":a()(u)))throw new Error("Invalid configurations passed to Bootstrap.");for(var E in q=u.RenderHandlers||g,U=u.RequestHandler,N=u.preRenderApp,M=u.postRenderApp,z=Boolean(u.isDevMode),u.serverConfig)k.hasOwnProperty(E)&&(k[E]=u.serverConfig[E]);P=u.defaultLocale||"en",Z.defaultLocale=P,Z.ProcessGetRequest=A,Z.Logger=t,Z.GetWidgetInstance=o,Z.GetAllWidgetInstance=r,Z.GetExtensionInstance=s,Z.DeleteWidgetInstance=c,Z.GetWidgetRegisterCallback=n,Z.GetMeta=R,Z.TriggerEventListeners=L,Z.FetchLocaleResource=T,Z.RenderWidget=d;var I=u.EventListeners||{};for(E in I)I.hasOwnProperty(E)&&(v=E,h=I[E],Q.hasOwnProperty(v)||(Q[v]=[]),Q[v].push(h));l=p.Init(Z),window.addEventListener("message",l),j=!0,t.Info("Running in Dev Mode : ",_()),i(e)}catch(e){f(e.message)}})},e.isInitialized=function(){return j},e.LoadExtension=function(e){return v.isInitialized()||t.Error("Bootstrap not yet initialized."),y(e)},e.LoadWidget=function(e){if(v.isInitialized()){t.Info("Load App : [ "+e.url+","+e.location+"]"),e.ondemand||C.push(e),H[e.location]=e.meta;var n=new l(e);return d(e.location,n)}t.Error("Bootstrap not yet initialized.")},e.GetMeta=R,e.RenderWidgets=function(e,n){t.Info("Render Apps with LocationID => ",e),H[e]=n;for(var o=0;o<C.length;o++){var i=C[o];try{var r=i.location;if(Array.isArray(r)&&-1===r.indexOf(e)||r!==e)continue;var a=new l(i);d(e,a)}catch(e){t.Error("Exception while Rendering Widget ==> ",e)}}},e.GetWidgetInstance=o,e.GetWidgetsByEvent=function(e){var t=r(),n=[];for(var o in t)t.hasOwnProperty(o)&&void 0!==t[o]._bindedEvents[e]&&n.push(o);return n},e.GetAllWidgetInstance=r,e.DeleteWidgetInstance=c,e.GetExtensionInstance=s,e.GetExtensionConfig=function(e){var t=s(e);return t&&t.config},e.GetConnectors=function(e){return V.filter(function(t){return t.extension_id&&t.extension_id===e})},e.isDevMode=_,e.toggleDevMode=function(){z=!z},e.BroadcastEvent=function(e,t,n){return p.BroadcastEvent(e,t,n)},e.DeleteAllExtensions=function(){var e=r();for(var t in e)if(e.hasOwnProperty(t)){var n=document.getElementById(t);n&&n.parentNode&&n.parentNode.removeChild(n)}B={},C=[],F={},V=[]},e.DeleteExtension=function(e){var t=r();for(var n in t)if(t.hasOwnProperty(n)&&t[n].getExtensionID()===e){var o=document.getElementById(n);o.parentNode.removeChild(o),F[n]=void 0,delete F[n]}C=b(C,e),V=b(V,e),B[e]=void 0,delete B[e]},e.getLogger=f.getLogger,e.GetExtensionBaseURL=m,e}catch(e){t.Error("Error Occured ",e.message)}}(window.ZApp||{})}}]);