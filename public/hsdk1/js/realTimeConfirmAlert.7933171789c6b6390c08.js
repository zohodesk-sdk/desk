(window.deskappJsonp=window.deskappJsonp||[]).push([[127],{"../components/lib/Button/Button.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=l(n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js")),r=l(n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/prop-types/index.js")),a=l(n("../components/lib/Button/Button.module.css")),c=n("../components/lib/utils/dummyFunction.js");function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.palette,o=e.disabled,r=e.size,c=e.onClick,l=e.rounded,s=e.status,u=e.children,d=e.isBold,f=e.dataId,m=e.needAppearance,p=e.className,b=e.getRef,I=m?a.default[n.toLowerCase()]+" "+(l?a.default.rounded:"")+"   "+(u?a.default["button_"+r.toLowerCase()]:a.default[r.toLowerCase()]):""+a.default.default;return i.default.createElement("button",{className:(p||"")+" "+I+" "+(d?a.default.bold:"")+"  ","data-id":o?f+"_disabled":f,disabled:o||"loading"===s.toLowerCase(),onClick:c,type:"button",ref:b},u||t,"none"!==s&&m&&i.default.createElement("div",{className:a.default.overlay},i.default.createElement("div",{className:"loading"===s.toLowerCase()?a.default.loading:a.default.success},i.default.createElement("div",{className:a.default.element}))))}}]),t}();t.default=s,s.defaultProps={children:null,dataId:"buttonComp",disabled:!1,isBold:!0,needAppearance:!0,onClick:c.dummyFunction,palette:"primary",rounded:!1,size:"medium",status:"none",text:"Button"},s.propTypes={children:r.default.node,className:r.default.string,dataId:r.default.string,disabled:r.default.bool,getRef:r.default.func,isBold:r.default.bool,needAppearance:r.default.bool,onClick:r.default.func,palette:r.default.oneOf(["plainPrimary","plainSecondary","primary","primaryFilled","danger","dangerFilled","secondary","secondaryFilled","successFilled","info"]),rounded:r.default.bool,size:r.default.oneOf(["small","medium","large","xlarge"]),status:r.default.oneOf(["loading","success","none"]),text:r.default.string},s.propTypesDescription={onClick:" ",text:" ",palette:" ",disabled:" ",size:" ",rounded:" ",status:" ",isBold:" ",children:" "}},"./src/actions/AgentCollisionActions.js":function(e,t,n){"use strict";n.d(t,"g",function(){return l}),n.d(t,"j",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return m}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return I}),n.d(t,"f",function(){return g});var o=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/assign.js"),i=n.n(o),r=n("./src/utils/RequestAPI.js"),a=n("./src/utils/Common.js"),c=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/simple-normalizr/es/index.js");function l(e){return{types:Object(a.m)("COLLIDING_USERS"),callAPI:function(t,n){return Object(r.a)("/api/v1/tickets/"+e+"/collision?include=author",!1,{orgId:t.currentOrgId}).get().then(function(e){var t=n(),o=Object(c.b)(e.collisionUsers,Object(c.a)(Object(c.c)("collisionUser",{id:"agentId",mapping:{author:Object(c.c)("agent")}}))),r=e.collisionUsers;return r=b(r=r.filter(function(e){return e.agentId&&e.agentId!=t.myInfo.id})),{collisionData:e=i()({},e,{collisionUsers:r,activeUsersLen:r.length}),entities:{agent:o.entities.agent}}})}}}function s(e,t,n){return{types:Object(a.m)("PUBLISH_USERACTION"),callAPI:function(o){return Object(r.a)("/api/v1/tickets/"+e+"/collision/userAction",!1,{orgId:o.currentOrgId}).post("",{actionType:t,instanceId:n}).then(function(e){return e})}}}function u(e,t){return{types:Object(a.m)("CREATE_CHAT"),callAPI:function(n){return Object(r.a)("/api/v1/tickets/"+e+"/collision/userChatAction",!1,{orgId:n.currentOrgId}).post("",{actionType:"createChat",agentId:t}).then(function(e){return e})}}}function d(e){return{types:Object(a.m)("CREATE_GROUPCHAT"),callAPI:function(t){return Object(r.a)("/api/v1/tickets/"+e+"/collision/userChatAction",!1,{orgId:t.currentOrgId}).post("",{actionType:"createGroupChat"}).then(function(e){return e})}}}function f(e){return{types:Object(a.m)("JOIN_CHAT"),callAPI:function(t){return Object(r.a)("/api/v1/tickets/"+e+"/collision/userChatAction",!1,{orgId:t.currentOrgId}).post("",{actionType:"joinChat"}).then(function(e){return e})}}}function m(e){return{types:Object(a.m)("LEAVE_CHAT"),callAPI:function(t){return Object(r.a)("/api/v1/tickets/"+e+"/collision/userChatAction",!1,{orgId:t.currentOrgId}).post("",{actionType:"leaveChat"}).then(function(e){return e})}}}function p(e,t){return{types:Object(a.m)("ADD_CHATMEMBERS"),callAPI:function(n){return Object(r.a)("/api/v1/tickets/"+e+"/collision/userChatAction",!1,{orgId:n.currentOrgId}).post("",{actionType:"addChatMembers",agentId:t}).then(function(e){return e})}}}function b(e){var t=0,n=0;return e=e.map(function(e,o){var r=Math.floor(o/4);if(n=55*r,0!=o){var a=(o+1)%4-1;t=a<0?165:55*a}return i()(e,{leftPos:t,topPos:n})})}function I(e){return{type:"CLEAR_COLLISION_DATA",data:{ticketId:e}}}function g(){return{types:Object(a.m)("GET_COLLISION_COMPRESS_META"),shouldCallAPI:function(e){return!e.ticketUIStatecollisionCompressMeta},callAPI:function(e){return Object(r.a)("/api/v1/realTime/ticketMeta",!1,{orgId:e.currentOrgId}).get().then(function(e){return e})}}}},"./src/actions/RealTimeActions.js":function(e,t,n){"use strict";n.d(t,"b",function(){return I}),n.d(t,"d",function(){return g}),n.d(t,"o",function(){return h}),n.d(t,"e",function(){return O}),n.d(t,"a",function(){return E}),n.d(t,"p",function(){return C}),n.d(t,"r",function(){return _}),n.d(t,"t",function(){return y}),n.d(t,"s",function(){return j}),n.d(t,"q",function(){return A}),n.d(t,"u",function(){return v}),n.d(t,"k",function(){return k}),n.d(t,"c",function(){return T}),n.d(t,"n",function(){return N}),n.d(t,"m",function(){return L}),n.d(t,"l",function(){return S}),n.d(t,"f",function(){return D}),n.d(t,"h",function(){return R}),n.d(t,"i",function(){return U}),n.d(t,"j",function(){return M}),n.d(t,"g",function(){return z});var o=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/promise.js"),i=n.n(o),r=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/toConsumableArray.js"),a=n.n(r),c=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/assign.js"),l=n.n(c),s=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/defineProperty.js"),u=n.n(s),d=n("./src/utils/RequestAPI.js"),f=n("./src/utils/Common.js"),m=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/simple-normalizr/es/index.js"),p=n("./src/constants/index.js"),b=n("./src/actions/AgentCollisionActions.js");function I(e,t,n){var o=n?"TICKET_ADD_COMMENT":"TICKET_ADD_CONVERSATION";return{types:Object(f.m)(o),callAPI:function(n,o){return Object(d.a)("/api/v1/tickets/"+e+"/comments/"+t+"?include=mentions",!1,{orgId:n.currentOrgId}).get().then(function(t){var n,i="1",r=o().module.ticket[e].commentCount;return(r=parseInt(r))&&r>0&&(i=r+1),{entities:(n={},u()(n,p.R.COMMENT_L,u()({},t.id,t)),u()(n,"ticket",u()({},e,u()({},p.R.COMMENT_L,[t.id]))),n),commentCount:i,result:e}})}}}function g(e,t,n){return function(o,i){var r="0",a=i().module.ticket[e].commentCount;(a=parseInt(a))&&(r=a-1),o({type:n?"TICKET_DELETE_COMMENT_SUCCESS":"TICKET_DELETE_CONVERSATION_SUCCESS",data:{entities:{ticket:u()({},e,u()({},p.R.COMMENT_L,[t]))},commentCount:r,result:e}})}}function h(e,t){return{types:Object(f.m)("UPDATECOMMENT"),callAPI:function(n){return Object(d.a)("/api/v1/tickets/"+e+"/comments/"+t,!1,{orgId:n.currentOrgId}).get().then(function(e){return{entities:{comment:u()({},t,e)}}})}}}function O(){return{types:Object(f.m)("REALTIMEDATA"),callAPI:function(e){return Object(d.a)("/api/v1/temp/realTimeMeta",!1,{orgId:e.currentOrgId}).get().then(function(e){return e})}}}function E(e,t){return{types:Object(f.m)("ADDTHREAD"),callAPI:function(n,o){return Object(d.a)("/api/v1/tickets/"+e+"/threads/"+t,!1,{orgId:n.currentOrgId}).get().then(function(t){var n=o(),i=t.id;if(!Object(f.L)(n,e,i)){var r=u()({},i,t),c=l()({},r,n.module.thread),s=n.module.ticket[e].thread||[],d=n.module.ticket[e].conversationIds||[],m=[i].concat(a()(s)),p=[{id:i,type:"thread"}].concat(a()(d));return{data:t,entities:{thread:c,ticket:u()({},e,{thread:m,conversationIds:p})}}}})}}}function C(e,t){return{types:Object(f.m)("UPDATETHREAD"),callAPI:function(n,o){return Object(d.a)("/api/v1/tickets/"+e+"/threads/"+t,!1,{orgId:n.currentOrgId}).get().then(function(n){var i=o(),r=i.module.ticket[e].conversationIds||[],a=i.module.ticket[e].thread||[];if(r.length){for(var c=0,l=0;l<=r.length;l++)if(r[l].id==t){c=l;break}r.splice(0,0,r.splice(c,1)[0])}else{var s=a.indexOf(t);a.splice(0,0,a.splice(s,1)[0])}return{data:n,entities:{thread:u()({},t,n),ticket:u()({},e,{conversationIds:r,thread:a})}}})}}}function _(e){return function(t,n){var o=e.author,i=e.ticketId,r=Object(m.b)(o,Object(m.c)("agent")),a=n(),c=l()({},a.collidingData[i]),s=c.collisionUsers,u=c.activeUsersLen,d=void 0===u?0:u;s=s?s.filter(function(e){if(e.agentId!=a.myInfo.id&&e.agentId!=o.id)return e}):[],s=[{agentId:o.id,userAction:"viewing"}].concat(s),s=Object(b.c)(s),t({type:"HANDLE_USERIN_SUCCESS",data:{collisionData:l()(c,{collisionUsers:s,ticketId:i,activeUsersLen:d+1,noViewers:!1}),entities:{agent:r.entities.agent}}})}}function y(e,t){return function(n,o){var i=o(),r=l()({},i.collidingData[e]),a={},c=r.collisionUsers,s=r.activeUsersLen;c=c?c.filter(function(e){if(e.agentId!=i.myInfo.id){if(e.agentId!=t)return e;a=e}}):[],a.userAction="isLeft";var u=new Date,d=u.getHours(),f=u.getMinutes(),m=d>=12?"P.M.":"A.M.",p=(d=(d%=12)||12)+":"+(f=f<10?"0"+f:f)+" "+m;a.time=p,c.push(a),c=Object(b.c)(c);var I=1==s;n({type:"HANDLE_USEROUT_SUCCESS",data:{collisionData:l()(r,{collisionUsers:c,ticketId:e,activeUsersLen:s-1,noViewers:I})}})}}function j(e,t){return function(n,o){var i=o(),r=l()({},i.collidingData[e]),a={},c=r.collisionUsers;c=c?c.filter(function(e){if(e.agentId!=i.myInfo.id){if(e.agentId!=t)return e;a=e}}):[],a.userAction="viewing",c=[a].concat(c),c=Object(b.c)(c),n({type:"HANDLE_USERONLINE_SUCCESS",data:{collisionData:l()(r,{collisionUsers:c,ticketId:e})}})}}function A(e,t){return function(n,o){var i=o(),r=l()({},i.collidingData[e]),a={},c=r.collisionUsers;c=c?c.filter(function(e){if(e.agentId!=i.myInfo.id){if(e.agentId!=t)return e;a=e}}):[],a.userAction="idle",c.push(a),c=Object(b.c)(c),n({type:"HANDLE_USERIDLE_SUCCESS",data:{collisionData:l()(r,{collisionUsers:c,ticketId:e})}})}}function v(e,t){return function(n,o){var i=o(),r=l()({},i.collidingData[e]),a={},c=r.collisionUsers;c=c?c.filter(function(e){if(e.agentId!=i.myInfo.id){if(e.agentId!=t)return e;a=e}}):[],a.userAction="replying",a.agentId=t,c=[a].concat(c),c=Object(b.c)(c),n({type:"HANDLE_USERREPLY_SUCCESS",data:{collisionData:l()(r,{collisionUsers:c,ticketId:e})}})}}function k(e){return function(t){t({type:"SET_NOVIWERS_SUCCESS",data:{collisionData:l()({ticketId:e,noViewers:!0,collisionUsers:[],activeUsersLen:0})}})}}function T(e,t){return function(n){n({type:"TICKET_THREAD_DELETE_SUCCESS",data:{ticketId:e,threadId:t}})}}function N(e){return function(t){t({type:"UPDATE_COLLISION_DATA_SUCCESS",data:{collisionData:e}})}}function L(e){var t={};return t.ticketId=e.ticketId,t.chatId=e.chatId,t.chatUsers=e.chatUsers,function(e){e({type:"UPDATE_COLLISION_CHATDATA",data:{chatData:t}})}}function S(e,t){var n=Date.now();return t=l()({},t,{notificationId:n,notificationTime:n}),function(n){n({type:"SHOW_COLLISION_NOTIFICATION",data:{ticketId:e,res:t}})}}function D(e,t){return function(n){n({type:"HIDE_COLLISION_NOTIFICATION",data:{ticketId:e,notificationId:t}})}}function R(e,t){return function(n){n({type:"REMOVE_COLLISION_NOTIFICATION",data:{ticketId:e,notificationId:t}})}}function U(e,t){return function(n){n({type:"RESET_NOTIFICATION_LIST",data:{ticketId:e,notificationList:t}})}}function M(e){return function(t){t({type:"REVOKE_BLUPRINT_SUCCESS",data:{entities:{ticket:u()({},e,{transitionData:""})}}})}}var z=function(){var e={resolve:null,reject:null};return{ob:e,showConfirmBox:function(t){return function(n){return n(function(e){return{type:"SHOW_REALTIMECONFIRM_ALERT",data:e}}(t)),new i.a(function(t,o){e.resolve=function(){n({type:"HIDE_REALTIMECONFIRM_ALERT"}),t()},e.reject=function(){n({type:"HIDE_REALTIMECONFIRM_ALERT"}),o()}})}}}}()},"./src/components/Subtab/RealTimeConfirmAlert/RealTimeConfirmAlert.module.css":function(e,t,n){e.exports={popup:"zd-realtimeconfirmalert-popup",header:"zd-realtimeconfirmalert-header",information:"zd-realtimeconfirmalert-information",name:"zd-realtimeconfirmalert-name zdbce71b4599 zdccf2edd024",footer:"zd-realtimeconfirmalert-footer",footerTitle:"zd-realtimeconfirmalert-footerTitle",lastButton:"zd-realtimeconfirmalert-lastButton"}},"./src/containers/Subtab/RealTimeConfirmAlert/RealTimeConfirmAlert.js":function(e,t,n){"use strict";n.r(t);var o=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react/index.js"),i=n.n(o),r=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/prop-types/index.js"),a=n.n(r),c=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/react-redux/es/index.js"),l=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),s=n.n(l),u=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/classCallCheck.js"),d=n.n(u),f=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/createClass.js"),m=n.n(f),p=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),b=n.n(p),I=n("../../../../npm-global/lib/node_modules/@zohodesk/react-cli/node_modules/babel-runtime/helpers/inherits.js"),g=n.n(I),h=n("./src/components/Subtab/RealTimeConfirmAlert/RealTimeConfirmAlert.module.css"),O=n.n(h),E=n("./src/components/FreezeLayer/FreezeLayer.js"),C=n("../components/lib/Avatar/Avatar.js"),_=n.n(C),y=n("../components/lib/Button/Button.js"),j=n.n(y),A=n("./src/fz-i18n/index.js"),v=n("./src/utils/Common.js"),k=n("./src/actions/RealTimeActions.js"),T=function(e){function t(e){d()(this,t);var n=b()(this,(t.__proto__||s()(t)).call(this,e));return n.documentKeyupHandler=n.documentKeyupHandler.bind(n),n}return g()(t,e),m()(t,[{key:"componentDidMount",value:function(){document.addEventListener("keyup",this.documentKeyupHandler)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.documentKeyupHandler)}},{key:"documentKeyupHandler",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&e.preventDefault();var t=this.props.confirmData,n=t.mode;27===e.keyCode&&n?k.g.ob.reject():13===e.keyCode&&n&&k.g.ob.resolve(t.ticketId,t.mode)}},{key:"render",value:function(){var e=this.props,t=e.confirmData,n=e.agents,o=void 0===n?{}:n,r=e.moduleMeta,a=t.mode,c=t.actionBy,l=t.newDep,s=t.oldDep,u=t.ticketId,d=o[c]||{};return a?i.a.createElement(E.a,{align:"horizontal",isActive:!0,animationName:"fade",runOnMount:!0},i.a.createElement("div",{className:O.a.popup},i.a.createElement("div",{className:O.a.header},i.a.createElement(_.a,{size:"xmedium",src:d.photoURL,name:d.name||Object(v.e)(d.firstName,d.lastName)}),i.a.createElement("p",{className:O.a.information},i.a.createElement("span",{className:O.a.name},d.name||Object(v.e)(d.firstName,d.lastName))," ","switchDep"===a?i.a.createElement("span",null,A.h.getI18NValue("support.label.collision.ticket.movedept",[r.tickets.singularLabel])," ",i.a.createElement("span",{className:O.a.name},s)," ",A.h.getI18NValue("to")," ",i.a.createElement("span",{className:O.a.name},l)," ",A.h.getI18NValue("support.mailserver.list.department")):"trash"===a||"spamDelete"===a?i.a.createElement("span",null,A.h.getI18NValue("support.label.collision.ticket.delete",[r.tickets.singularLabel])):null)),i.a.createElement("div",{className:O.a.footer},i.a.createElement("div",{className:O.a.footerTitle},"switchDep"===a?A.h.getI18NValue("support.label.collision.detection.ticket.movedept.stay",[r.tickets.singularLabel]):"trash"==a?A.h.getI18NValue("support.label.collision.detection.ticket.delete.question",[r.tickets.singularLabel]):"spamDelete"==a?A.h.getI18NValue("support.label.collision.detection.ticket.movedept.stay",[r.tickets.singularLabel]):null),i.a.createElement("div",{className:O.a.submit},i.a.createElement(j.a,{text:A.h.getI18NValue("support.yes"),size:"Medium",palette:"primaryFilled",onClick:function(){k.g.ob.resolve(u,a)}}),i.a.createElement("span",{className:O.a.lastButton},i.a.createElement(j.a,{text:"trash"===a?A.h.getI18NValue("support.no"):A.h.getI18NValue("support.exit"),size:"Medium",palette:"secondary",onClick:function(){k.g.ob.reject()}})))))):null}}]),t}(i.a.Component),N=T;T.propTypes={agents:a.a.object,confirmData:a.a.object,moduleMeta:a.a.object};t.default=Object(c.connect)(function(e,t){return{confirmData:e.realTimeConfirmAlert,moduleMeta:e.moduleMeta,agents:e.module.agent}},{})(N)}}]);