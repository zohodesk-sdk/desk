(window.deskappJsonp=window.deskappJsonp||[]).push([[49],{1186:function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"d",function(){return u}),n.d(e,"g",function(){return c}),n.d(e,"j",function(){return d}),n.d(e,"h",function(){return l}),n.d(e,"e",function(){return p}),n.d(e,"a",function(){return m}),n.d(e,"f",function(){return g}),n.d(e,"b",function(){return f}),n.d(e,"i",function(){return O});var a=n(5),r=n.n(a),i=n(15),s=n(6);function o(t){return{types:Object(s.m)("GET_APPLIED_BLUEPRINT"),callAPI:function(e){return Object(i.a)("/api/v1/tickets/"+t+"/blueprint?include=transitionOwnerAgents,transitionOwnerTeams,transitionOwnerDept",!1,{orgId:e.currentOrgId}).get().then(function(e){return{entities:{ticket:r()({},t,{transitionData:204==e.responseStatus?"":e})},result:[]}})}}}function u(t,e){return{types:Object(s.m)("GET_TRANSITIONS"),callAPI:function(n){return Object(i.a)("/api/v1/tickets/"+t+"/transitions/"+e+"/form",!1,{orgId:n.currentOrgId}).get().then(function(t){return t})}}}function c(t,e,n){return{types:Object(s.m)("PERFORM_TRANSITION"),callAPI:function(a){return Object(i.a)("/api/v1/tickets/"+t+"/transitions/"+e+"/perform",!1,{orgId:a.currentOrgId}).post("",n).then(function(e){return{entities:{ticket:r()({},t,{status:e.updatedState})},result:[]}})}}}function d(t,e,n){return{types:Object(s.m)("VALIDATE_FIELD_UPDATES"),callAPI:function(a){return Object(i.a)("/api/v1/tickets/"+t+"/transitions/"+e+"/validateFieldUpdates",!1,{orgId:a.currentOrgId}).post("",n).then(function(t){return t})}}}function l(t){return{types:Object(s.m)("REVOKE_BLUEPRINT"),callAPI:function(e){return Object(i.a)("/api/v1/tickets/"+t+"/revokeBlueprint",!1,{orgId:e.currentOrgId}).post().then(function(e){return{entities:{ticket:r()({},t,{transitionData:""})},result:[]}})}}}function p(){return{type:"OPEN_FLOWCHAT"}}function m(){return{type:"CLOSE_FLOWCHAT"}}function g(t){return{type:"OPEN_TRANSITION_FORM",data:t}}function f(){return{type:"CLOSE_TRANSITION_FORM"}}function O(t){return{type:"TOGGLE_TRANSITION_FORM",data:t}}},1766:function(t,e,n){t.exports={contentDiv:"AssginOwnerPopup-module__contentDiv",title:"AssginOwnerPopup-module__title common-module__bold common-module__ftsmooth",detailDiv:"AssginOwnerPopup-module__detailDiv common-module__ftsmooth",assignList:"AssginOwnerPopup-module__assignList",titleName:"AssginOwnerPopup-module__titleName common-module__ftsmooth common-module__dotted common-module__oflow common-module__ellipsis",errorMsg:"AssginOwnerPopup-module__errorMsg",dropdownIcon:"AssginOwnerPopup-module__dropdownIcon",dropList:"AssginOwnerPopup-module__dropList",listOption:"AssginOwnerPopup-module__listOption",listItem:"AssginOwnerPopup-module__listItem"}},666:function(t,e,n){"use strict";n.r(e);var a,r=n(12),i=n.n(r),s=n(9),o=n.n(s),u=n(10),c=n.n(u),d=n(13),l=n.n(d),p=n(14),m=n.n(p),g=n(0),f=n.n(g),O=n(1),I=n.n(O),h=n(26),b=(n(1186),n(956)),v=n(24),T=n(6),A=n(5),_=n.n(A),N=n(1766),w=n.n(N),j=n(30),E=n(254),L=n.n(E),C=n(72),y=n.n(C),P=n(8),S=n(62),D=function(t){function e(t){o()(this,e);var n=l()(this,(e.__proto__||i()(e)).call(this,t));return n.onTabChange=n.onTabChange.bind(n),n.onOwnerChange=n.onOwnerChange.bind(n),n}return m()(e,t),c()(e,[{key:"onTabChange",value:function(t){this.props.onTabChange(t)}},{key:"onOwnerChange",value:function(t){var e=this.props,n=e.defaultTab,a=e.onOwnerChange;a(t,n)}},{key:"render",value:function(){var t=this,e=this.props,n=e.defaultTab,a=e.closeOwnerPopup,r=e.departmentName,i=e.options,s=e.selectedOptions,o=e.isMaxLen,u=e.assignTransitionOwner,c=e.updateButtonStatus;return f.a.createElement(f.a.Fragment,null,f.a.createElement(S.c,{title:r,paddingSize:"small"}),f.a.createElement(S.a,{className:w.a.contentDiv,paddingSize:"small"},f.a.createElement("div",{className:w.a.title},P.f.getI18NValue("support.blueprint.label.transition.owners")),f.a.createElement("div",{className:w.a.detailDiv},P.f.getI18NValue("support.blueprint.label.choosing.agent.and.team.description")),f.a.createElement("div",{className:w.a.assignDropbox},f.a.createElement("div",{className:w.a.assignList},f.a.createElement("span",{className:w.a.titleName},"agent"==n?P.f.getI18NValue("support.survey.report"):P.f.getI18NValue("support.setup.label.teams")),f.a.createElement("span",{className:w.a.dropdownIcon},f.a.createElement(j.TopbandFontIcon,{name:"blockDownArrow",size:"8"}),f.a.createElement("span",{className:w.a.dropList},f.a.createElement(y.a,{size:"mini",boxPosition:"bottomRight",isActive:!0},f.a.createElement("div",{className:w.a.listOption},f.a.createElement("div",{className:w.a.listItem,onClick:function(){t.onTabChange("teams")}},P.f.getI18NValue("support.setup.label.teams")),f.a.createElement("div",{className:w.a.listItem,onClick:function(){t.onTabChange("agent")}},P.f.getI18NValue("support.survey.report"))))))),f.a.createElement("div",{className:w.a.multiSelect},f.a.createElement(L.a,{valueField:"id",textField:"name",options:i,selectedOptions:s,emptyMessage:P.f.getI18NValue("support.label.no.more.results"),onChange:function(e){t.onOwnerChange(e)},hideOptions:o,isTeam:"teams"==n})),o?f.a.createElement("div",{className:w.a.errorMsg},P.f.getI18NValue("support.blueprints.trans.owner.limit.msg")):null)),f.a.createElement(S.b,{submitText:P.f.getI18NValue("support.blueprint.label.assign.owners"),cancelText:P.f.getI18NValue("support.label.cancel"),submitStatus:c,onSubmit:u,onCancel:a,paddingSize:"small"}))}}]),e}(f.a.Component),k=D;D.propTypes=(a={assignTransitionOwner:I.a.func},_()(a,"assignTransitionOwner",I.a.func),_()(a,"closeOwnerPopup",I.a.func),_()(a,"closeOwnerPopup",I.a.func),_()(a,"closeOwnerPopup",I.a.func),_()(a,"departmentName",I.a.string),_()(a,"onTabChange",I.a.func),_()(a,"options",I.a.arrayOf(I.a.shape({id:I.a.string.isRequired,name:I.a.string.isRequired,photoURL:I.a.string.isRequired})).isRequired),_()(a,"selectedOptions",I.a.arrayOf(I.a.string).isRequired),a);var R=function(t){function e(t){o()(this,e);var n=l()(this,(e.__proto__||i()(e)).call(this,t));return n.state={defaultTab:"agent",selectedOptions:[]},n.onTabChange=n.onTabChange.bind(n),n.onOwnerChange=n.onOwnerChange.bind(n),n.assignTransitionOwner=n.assignTransitionOwner.bind(n),n}return m()(e,t),c()(e,[{key:"componentDidMount",value:function(){var t=this.props,e=t.departmentId,n=t.getAgentsList,a=t.getTeamsList;n(e,0,50),a(e)}},{key:"onTabChange",value:function(t){this.setState({defaultTab:t})}},{key:"onOwnerChange",value:function(t){this.setState({selectedOptions:t,isMaxLen:10==t.length})}},{key:"assignTransitionOwner",value:function(){var t=this,e=this.state.selectedOptions,n=this.props,a=n.bluePrintId,r=n.ticketId,i=n.assginOwnerDetails,s=n.departmentId,o=n.teamsIds,u=n.assignTransitionOwner,c=n.closeOwnerPopup,d=[],l=[];e.map(function(t){o.includes(t)?l.push(t):d.push(t)});var p={departmentId:s,agentIds:d,teamIds:l},m={blueprint:{id:a,transitions:[{id:i.transitionId,owners:i.owners.map(function(t){return t.departmentId==s?p:{departmentId:t.departmentId,agentIds:t.agentIds,teamIds:t.teamIds}})}]}};this.setState({updateButtonStatus:"loading"}),u(r,m).then(function(){t.setState({updateButtonStatus:"none"}),c()},function(){t.setState({updateButtonStatus:"none"})})}},{key:"render",value:function(){var t=this.props,e=t.departmentName,n=t.assginOwnerDetails,a=t.closeOwnerPopup,r=t.agentIds,i=void 0===r?[]:r,s=t.agents,o=t.teamsIds,u=void 0===o?[]:o,c=t.teams,d=this.state,l=d.defaultTab,p=d.selectedOptions,m=d.isMaxLen,g=d.updateButtonStatus,O=void 0===g?"none":g,I=[],h=[];return i.map(function(t){var e=s[t],n=e.isConfirmed,a=e.rolePermissionType,r=e.id,i=e.firstName,o=e.lastName,u=e.photoURL;n&&"Light"!=a&&I.push({id:r,name:Object(T.t)(i,o),photoURL:u})}),u.map(function(t){var e=c[t],n=e.id,a=e.name;h.push({id:n,name:a})}),f.a.createElement(k,{defaultTab:l,departmentName:e,assginOwnerDetails:n,closeOwnerPopup:a,onTabChange:this.onTabChange,options:"agent"==l?I:h,selectedOptions:p,onOwnerChange:this.onOwnerChange,isMaxLen:m,updateButtonStatus:O,assignTransitionOwner:this.assignTransitionOwner})}}]),e}(g.Component);R.propTypes={assginOwnerDetails:I.a.object,closeOwnerPopup:I.a.func,departmentId:I.a.string,departmentName:I.a.string,getAgentsList:I.a.func,getTeamsList:I.a.func,ticketId:I.a.string};e.default=Object(h.connect)(function(t,e){var n=t.departmentSpecificState[e.departmentId];return{agentIds:t.activeAgents[e.departmentId],agents:t.module.agent,teams:t.module.teams,teamsIds:n&&n.teamsList}},{getAgentsList:b.g,getTeamsList:v.u})(R)},956:function(t,e,n){"use strict";n.d(e,"i",function(){return p}),n.d(e,"g",function(){return m}),n.d(e,"b",function(){return g}),n.d(e,"j",function(){return f}),n.d(e,"h",function(){return O}),n.d(e,"c",function(){return I}),n.d(e,"e",function(){return h}),n.d(e,"a",function(){return b}),n.d(e,"k",function(){return T}),n.d(e,"d",function(){return _}),n.d(e,"f",function(){return N}),n.d(e,"l",function(){return w});n(20);var a=n(2),r=n.n(a),i=n(15),s=n(6),o=n(7),u=n(17),c=n(46),d=n(3),l=n(39);function p(t){return{types:Object(s.m)("AGENTS_COUNT"),callAPI:function(e){var n=Object(u.r)(e);return Object(i.a)("/api/v1/agentsTicketsCount?"+Object(c.a)(e)+"&agentIds="+t,!1,{orgId:e.currentOrgId}).get().then(function(t){return 204!==t.responseStatus?(t.data=t.data.map(function(t){return r()({},t,{id:t.agentId})}),{countData:t.data,deptId:n}):{}})}}}function m(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{types:Object(s.m)(d.L.AGENT),callAPI:function(s){return Object(i.a)("/api/v1/agents?"+(t&&"allDepartment"!==t?"departmentId="+t:"")+"&from="+e+"&limit="+n+"&status=ACTIVE&isConfirmed="+a,!1,{orgId:s.currentOrgId}).get().then(function(e){if(204!==e.responseStatus){var a=e.data.length<n,i=Object(o.normalize)(e.data,Object(o.arrayOf)(Object(o.schema)(d.L.AGENT_L)));return r()(i,{noMoreData:a,depId:t})}return{entities:{noMoreData:!0},result:[]}})}}}function g(t,e){return{types:Object(s.m)(d.L.AGENT),callAPI:function(n){return Object(i.a)("/api/v1/agents/"+t,!1,{orgId:n.currentOrgId}).get().then(function(t){var n=Object(o.normalize)(t,Object(o.schema)(d.L.AGENT_L));return r()(n,{depId:e})})}}}function f(t,e,n){return{types:Object(s.m)("AGENT_SEARCH"),callAPI:function(a){return Object(i.a)("/api/v1/agents?searchStr="+t+"&from="+e+"&limit="+n,!1,{orgId:a.currentOrgId}).get().then(function(t){if(204!==t.responseStatus){var a=t.data.length<n,i=Object(o.normalize)(t.data,Object(o.arrayOf)(Object(o.schema)(d.L.AGENT_L)));return r()(i,{noMoreData:a})}return 1===e?{entities:{noMoreData:!0,isEmpty:!0},result:[]}:{entities:{noMoreData:!0},result:[]}})}}}function O(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments[1],n=arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d.u,l=arguments[4];return{types:Object(s.m)(d.L.AGENT),callAPI:function(s){var p={activeAgents:"status=ACTIVE",deActiveAgents:"status=DISABLED",notConfirmedAgents:"isConfirmed=false",allAgents:"",activeConfirmedAgents:"status=ACTIVE&isConfirmed=true",activeConfirmedNonLightAgents:"status=ACTIVE&isConfirmed=true&rolePermissionType=${NON_LIGHT}"}[t.replace("Search","")]||"",m=l||Object(u.r)(s),g=l?"&departmentId="+l:Object(c.a)(s,!0),f="/api/v1/agents?"+(p?p+"&":"")+"from="+e+"&limit="+(2*a>200?200:2*a)+(n?"&searchStr=*"+n+"*":"")+g;return Object(i.a)(encodeURI(f),!1,{orgId:s.currentOrgId}).get().then(function(i){return r()({},Object(o.normalize)(204!==i.responseStatus?i.data:[],Object(o.arrayOf)(Object(o.schema)(d.L.AGENT_L))),{deptId:m,from:e,limit:a,isNext:!!i.data&&i.data.length>a,searchStr:n,agentType:t})},function(t){throw t})}}}function I(t){return{types:Object(s.m)("AGENT"),shouldCallAPI:function(){return t.length>=1},callAPI:function(e){return Object(i.a)("/api/v1/agentsByIds?agentIds="+t.join(),!1,{orgId:e.currentOrgId}).get().then(function(t){return Object(o.normalize)(204!==t.responseStatus?t.data:[],Object(o.arrayOf)(Object(o.schema)(d.L.AGENT_L)))})}}}function h(t){return{types:Object(s.m)("TEAM_AGENT"),callAPI:function(e){return Object(i.a)("/api/v1/teams/"+t+"/members",!1,{orgId:e.currentOrgId}).get().then(function(t){return Object(o.normalize)(t.members,Object(o.arrayOf)(Object(o.schema)(d.L.AGENT_L)))})}}}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],n="";return e.map(function(e){void 0!==t[e]&&(n+="&"+e+"="+t[e])}),n}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],n=arguments[2];return void 0!==t[e]?t[e]:n}function T(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=v(t,"searchType","string"),n=t.searchStr;return n&&(n="string*"==e?n+"*":"*string*"==e?"*"+n+"*":n),n}function A(t){var e=t.isConfirmed,n=t.status;switch(n){case l.a:return l.a;case l.d:return l.d;case l.c:return l.c;default:if(void 0!==e&&!e)return l.l;if(void 0===n)return l.b}}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.from=v(t,"from","1"),t.limit=v(t,"limit","100"),t.searchStr=T(t);var e=t.from>1?l.k:l.j;return{types:Object(s.m)(e),callAPI:function(e){var n="/api/v1/agents?orgId="+e.currentOrgId;return n+=b(t,["from","limit","status","isConfirmed","searchStr","departmentId","departmentIds","profileIds","roleIds"]),Object(i.a)(n).get().then(function(e){return r()(Object(o.normalize)(void 0!==e.data?e.data:[],Object(o.arrayOf)(Object(o.schema)(d.L.AGENT_L))),{status:A(t)})})}}}function N(t,e,n){var a={status:t,isConfirmed:e,includeLightAgent:n};return a.includeLightAgent=v(a,"includeLightAgent",!0),{types:Object(s.m)(l.i),callAPI:function(t){var e="/api/v1/agents/count?orgId="+t.currentOrgId;return e+=b(a,["status","isConfirmed","includeLightAgent"]),Object(i.a)(e).get().then(function(t){return r()({},t,{status:A(a)})})}}}function w(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:l.m,data:{isEnabled:t}}}}}]);