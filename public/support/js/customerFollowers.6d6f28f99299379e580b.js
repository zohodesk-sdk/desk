(window.deskappJsonp=window.deskappJsonp||[]).push([[69],{1232:function(e,t,o){"use strict";o.d(t,"b",function(){return m}),o.d(t,"c",function(){return d}),o.d(t,"a",function(){return f});var n=o(2),r=o.n(n),a=o(5),l=o.n(a),s=o(15),i=o(6),c=o(3),u=o(7);function m(e,t){return{types:Object(i.m)(c.L.FOLLOWERS),callAPI:function(o){return Object(s.a)("/api/v1/"+e+"/"+t+"/followers",!1,{orgId:o.currentOrgId}).get().then(function(e){return 0==e.data.length?{entities:l()({},c.L.AGENT_L,{}),result:[]}:Object(u.normalize)(e.data,Object(u.arrayOf)(Object(u.schema)(c.L.AGENT_L)))})}}}function d(e,t,o){return{types:Object(i.m)(e.toUpperCase()+"_REMOVEFOLLOWER"),callAPI:function(n,a){return Object(s.a)("/api/v1/"+e+"/"+t+"/removeFollowers",!1,{orgId:n.currentOrgId}).post("",{followerIds:[o]}).then(function(s){if("tickets"==e){var i=a().module.ticket[t].followerCount,c={followerCount:parseInt(i)-1};return c=n.myInfo.id==o?r()(c,{isFollowing:!1}):c,{res:s,entities:{ticket:l()({},t,c)},result:[]}}return s})}}}function f(e,t,o){return{types:Object(i.m)(e.toUpperCase()+"_ADDFOLLOWER"),callAPI:function(n,a){return Object(s.a)("/api/v1/"+e+"/"+t+"/addFollowers",!1,{orgId:n.currentOrgId}).post("",{followerIds:[o]}).then(function(s){if("tickets"==e){var i=a().module.ticket[t].followerCount,c={followerCount:parseInt(i)+1};return c=n.myInfo.id==o?r()(c,{isFollowing:!0}):c,{res:s,entities:{ticket:l()({},t,c)},result:[]}}return s})}}}},1247:function(e,t,o){"use strict";var n=o(12),r=o.n(n),a=o(9),l=o.n(a),s=o(10),i=o.n(s),c=o(13),u=o.n(c),m=o(14),d=o.n(m),f=o(0),p=o.n(f),w=o(1),g=o.n(w),h=o(1248),_=o.n(h),E=o(30),v=o(120),y=o.n(v),F=function(e){function t(e){l()(this,t);var o=u()(this,(t.__proto__||r()(t)).call(this,e));return o.openUrl=o.openUrl.bind(o),o.editEntity=o.editEntity.bind(o),o.deleteEntity=o.deleteEntity.bind(o),o}return d()(t,e),i()(t,[{key:"openUrl",value:function(e){return function(){return window.open(e,"_blank")}}},{key:"deleteEntity",value:function(){var e=this.props,t=e.deleteEntity;t(e.entityId)}},{key:"editEntity",value:function(){var e=this.props,t=e.editEntity;t(e.entityId,e.entity)}},{key:"render",value:function(){var e=this.props,t=e.title,o=e.viewUrl,n=e.showActions,r=e.needBackBtn,a=e.showContactCrmInfo;return p.a.createElement("div",{className:_.a.followTitle},r?p.a.createElement("span",{className:_.a.backIcon,onClick:a},p.a.createElement(y.a,{name:"arrowLeft2",size:"13"})):null,p.a.createElement("span",{className:_.a.user},t),n||o?p.a.createElement("span",{className:_.a.fRight},n?p.a.createElement(p.a.Fragment,null,p.a.createElement("span",{className:_.a.icon,onClick:this.editEntity},p.a.createElement(E.TopbandFontIcon,{name:"pen2",size:"14",color:"smoke19",hoverColor:"primary"})),p.a.createElement("span",{className:_.a.icon,onClick:this.deleteEntity},p.a.createElement(E.TopbandFontIcon,{name:"delete2",size:"14",color:"smoke19",hoverColor:"danger15"}))):"",o?p.a.createElement("span",{className:_.a.icon},p.a.createElement(E.TopbandFontIcon,{name:"newtab",onClick:this.openUrl(o),size:"14"})):""):"")}}]),t}(f.Component);t.a=F,F.propTypes={deleteEntity:g.a.func,editEntity:g.a.func,entity:g.a.string,entityId:g.a.string,needBackBtn:g.a.bool,showActions:g.a.bool,showContactCrmInfo:g.a.func,title:g.a.string,viewUrl:g.a.string},F.defaultProps={showActions:!1}},1248:function(e,t,o){e.exports={followTitle:"LeftPanelHeader-module__followTitle",user:"LeftPanelHeader-module__user common-module__dotted common-module__oflow common-module__ellipsis",fRight:"LeftPanelHeader-module__fRight",icon:"LeftPanelHeader-module__icon"}},1476:function(e,t,o){"use strict";var n=o(12),r=o.n(n),a=o(9),l=o.n(a),s=o(10),i=o.n(s),c=o(13),u=o.n(c),m=o(14),d=o.n(m),f=o(0),p=o.n(f),w=o(1),g=o.n(w),h=o(1477),_=o.n(h),E=function(e){function t(e){return l()(this,t),u()(this,(t.__proto__||r()(t)).call(this,e))}return d()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.text;return p.a.createElement("div",{className:_.a.message},e)}}]),t}(f.Component);t.a=E,E.propTypes={text:g.a.string.isRequired}},1477:function(e,t,o){e.exports={message:"EmptyMessage-module__message"}},173:function(e,t,o){e.exports={container:"Loading-module__container",dot:"Loading-module__dot",bounce:"Loading-module__bounce"}},1752:function(e,t,o){e.exports={fpbtn:"Followers-module__fpbtn",proHgt:"Followers-module__proHgt",fProSection:"Followers-module__fProSection"}},1753:function(e,t,o){e.exports={section:"AccountFollowProfile-module__section",user:"AccountFollowProfile-module__user common-module__dotted common-module__oflow common-module__ellipsis",femptyTxt:"AccountFollowProfile-module__femptyTxt"}},458:function(e,t,o){"use strict";var n=o(12),r=o.n(n),a=o(9),l=o.n(a),s=o(10),i=o.n(s),c=o(13),u=o.n(c),m=o(14),d=o.n(m),f=o(0),p=o.n(f),w=o(173),g=o.n(w),h=o(16),_=function(e){function t(){return l()(this,t),u()(this,(t.__proto__||r()(t)).apply(this,arguments))}return d()(t,e),i()(t,[{key:"render",value:function(){return p.a.createElement(h.Container,{alignBox:"row",align:"both",className:g.a.container},p.a.createElement(h.Box,{className:g.a.dot}),p.a.createElement(h.Box,{className:g.a.dot}),p.a.createElement(h.Box,{className:g.a.dot}),p.a.createElement(h.Box,{className:g.a.dot}),p.a.createElement(h.Box,{className:g.a.dot}),p.a.createElement(h.Box,{className:g.a.dot}))}}]),t}(p.a.Component);t.a=_},671:function(e,t,o){"use strict";o.r(t);var n=o(5),r=o.n(n),a=o(2),l=o.n(a),s=o(23),i=o.n(s),c=o(12),u=o.n(c),m=o(9),d=o.n(m),f=o(10),p=o.n(f),w=o(13),g=o.n(w),h=o(14),_=o.n(h),E=o(0),v=o.n(E),y=o(26),F=o(1),I=o.n(F),b=o(1752),N=o.n(b),k=o(16),x=o(73),C=o.n(x),L=o(1247),O=o(1753),U=o.n(O),A=o(64),B=o.n(A),T=function(e){function t(){return d()(this,t),g()(this,(t.__proto__||u()(t)).apply(this,arguments))}return _()(t,e),p()(t,[{key:"render",value:function(){var e=this.props,t=e.name,o=e.size,n=e.imgSrc,r=e.emptyTxt;return v.a.createElement("div",{className:U.a.section},r?v.a.createElement("span",{className:U.a.femptyTxt},r):"",v.a.createElement(k.Container,{isCover:!1,align:"vertical",alignBox:"row"},v.a.createElement(k.Box,null,v.a.createElement(B.a,{src:n,name:t,size:o})),v.a.createElement(k.Box,{flexible:!0,className:U.a.user},t)))}}]),t}(E.Component),M=T;T.propTypes={emptyTxt:I.a.string,imgSrc:I.a.string,name:I.a.string,size:I.a.string};var P=o(1476),j=o(458),S=o(1232),z=o(24),R=o(8),H=o(6),V=function(e){function t(e){d()(this,t);var o=g()(this,(t.__proto__||u()(t)).call(this,e));return o.state={followers:{},followerIds:[],isUserFollowing:!1,waitingForAction:!1,isFetchDone:!1},o.addFollower=o.addFollower.bind(o),o.removeFollower=o.removeFollower.bind(o),o}return _()(t,e),p()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,o=t.getFollowersList,n=t.moduleMeta,r=t.currentUser,a=t.moduleId;o(n.apiKey,a).then(function(t){return e.setState({followers:t.data.entities.agent,followerIds:t.data.result,isFetchDone:!0,isUserFollowing:t.data.result.includes(r.id)})})}},{key:"addFollower",value:function(){var e=this,t=this.props,o=t.moduleId,n=t.addFollower,a=t.showMessage,s=t.module,c=t.moduleMeta,u=t.currentUser;this.setState({waitingForAction:!0}),n(s,o,u.id).then(function(t){a({type:"success",message:R.f.getI18NValue("support.customers.follow",[c.singularLabel])}),e.setState(function(e){return{followerIds:[u.id].concat(i()(e.followerIds)),followers:l()({},e.followers,r()({},u.id,u)),isUserFollowing:!e.isUserFollowing,waitingForAction:!1}})})}},{key:"removeFollower",value:function(){var e=this,t=this.props,o=t.module,n=t.moduleId,r=t.removeFollower,a=t.showMessage,s=t.moduleMeta,i=t.currentUser;this.setState({waitingForAction:!0}),r(o,n,i.id).then(function(t){a({type:"success",message:R.f.getI18NValue("support.customers.unfollow",[s.singularLabel])});var o=l()({},e.state.followers);delete o[i.id],e.setState(function(e){return{followerIds:e.followerIds.filter(function(e){return e!=i.id}),followers:o,isUserFollowing:!e.isUserFollowing,waitingForAction:!1}})})}},{key:"render",value:function(){var e=this.state,t=e.followers,o=e.followerIds,n=e.isUserFollowing,r=e.waitingForAction,a=e.isFetchDone,l=this.props.showFollow,s=void 0===l||l;return a?v.a.createElement(k.Container,{alignBox:"column",className:N.a.fProSection},v.a.createElement(k.Box,null,v.a.createElement(L.a,{title:R.f.getI18NValue("support.social.label.followers")})),r?v.a.createElement(j.a,null):v.a.createElement(E.Fragment,null,v.a.createElement(k.Box,{scroll:"vertical",className:N.a.proHgt,flexible:!0},o.length?o.map(function(e,o){return v.a.createElement(M,{name:Object(H.t)(t[e].firstName,t[e].lastName),size:"medium",imgSrc:t[e].photoURL,key:o})}):v.a.createElement(P.a,{text:R.f.getI18NValue("support.contact.follower.empty")})),s&&v.a.createElement(k.Box,{className:N.a.fpbtn},v.a.createElement(C.a,{text:n?R.f.getI18NValue("support.feed.label.unfollow"):R.f.getI18NValue("support.request.follow"),palette:"primary",onClick:n?this.removeFollower:this.addFollower})))):v.a.createElement(j.a,null)}}]),t}(E.Component);V.propTypes={addFollower:I.a.func,currentUser:I.a.object,getFollowersList:I.a.func,module:I.a.string,moduleId:I.a.string,moduleMeta:I.a.object,removeFollower:I.a.func,showFollow:I.a.bool,showMessage:I.a.func};t.default=Object(y.connect)(function(e){var t=e.moduleMapper[e.routing.paramMap.moduleName];return{module:t,moduleId:e.routing.paramMap.moduleId,currentUser:e.myInfo,moduleMeta:e.moduleMeta[t]}},{showMessage:z.Q,addFollower:S.a,removeFollower:S.c,getFollowersList:S.b})(V)}}]);