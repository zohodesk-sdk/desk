(window.deskappJsonp=window.deskappJsonp||[]).push([[53],{173:function(e,t,n){e.exports={container:"Loading-module__container",dot:"Loading-module__dot",bounce:"Loading-module__bounce"}},174:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"j",function(){return l}),n.d(t,"n",function(){return d}),n.d(t,"o",function(){return f}),n.d(t,"k",function(){return m}),n.d(t,"i",function(){return p}),n.d(t,"g",function(){return v}),n.d(t,"h",function(){return g}),n.d(t,"a",function(){return x}),n.d(t,"l",function(){return I}),n.d(t,"b",function(){return y}),n.d(t,"m",function(){return b}),n.d(t,"f",function(){return w});var a=n(11),r=n.n(a),o=n(177),s=n(8);function i(e){var t=u(e),n=Object(o.a)().toLowerCase()||"",a=navigator.platform.toLowerCase()||"";switch(t){case"jpeg":case"jpg":case"png":case"gif":case"bmp":case"tiff":case"tif":case"ico":return"filePicture";case"txt":case"rtf":return"fileText2";case"pdf":return"filePdf";case"html":case"htm":case"xhtml":return-1!==n.indexOf("chrome")||-1!==n.indexOf("safari")?"chrome":-1!==n.indexOf("ie")||-1!==n.indexOf("edge")?"ie":"firefox";case"ppt":case"pps":case"odp":case"sxi":case"pptx":return"ppt";case"rar":case"jar":case"zip":return"zip3";case"doc":case"docx":case"sxw":case"odt":return-1!==a.indexOf("mac")||-1!==a.indexOf("linux")?"fileOpenoffice":"fileWord";case"xml":return"xml";case"xls":case"xlsx":case"sxc":case"ods":case"csv":case"tsv":return"fileExcel";case"ics":return"ics";case"exe":return"exe";case"sh":case"bin":return"sh2";case"css":return"css52";case"mp3":case"wav":case"wma":case"aac":case"m4r":case"ogg":return"fileMusic";case"mp4":case"mkv":case"mov":case"mpeg":case"flv":case"avi":case"webm":return"fileVideo";default:return"unknown"}}function c(e){return(e=parseInt(e))<1e3?e+" Bytes":e<1e6?(e/1e3).toFixed(1)+" KB":e>=1e6?(e/1e6).toFixed(1)+" MB":void 0}function u(e){return e&&e.indexOf(".")?e.substring(e.lastIndexOf(".")+1,e.length).toLowerCase():""}function l(e){var t=u(e);return-1!=="jpeg|jpg|png|gif|bmp|ico".indexOf(t)}function d(e,t){var n={inValidArray:[],validArray:[]};if(t+e.length>10)return n.isCountExceeds=!0,n;for(var a=0;a<e.length;a++){var r=e[a],o=r.name,s=r.size;m(o)?n.inValidArray.push({isUnSupported:!0}):p(o)?n.inValidArray.push({isFileNameSizeInvalid:!0}):0===r.size?n.inValidArray.push({isEmpty:!0}):h(s)?n.inValidArray.push({isAttachSizeExceeded:!0}):n.validArray.push(r)}return n}function f(e,t,n){if(t+e.length>10)alert(s.f.getI18NValue("support.attachments.count.exceeds",[10]));else for(var a=0;a<e.length;a++){var r=e[a],o=r.name,i=r.size;if(m(o))alert(s.f.getI18NValue("support.community.attachmentcontent.extensionnotpermitted"));else if(p(o))alert(s.f.getI18NValue("support.comments.attachment.fileNameSizeLimitation"));else if(0!==r.size)if(h(i))alert(s.f.getI18NValue("support.feedback.uploaded.file.exceeds.20mb"));else{var c=new FormData;c.append("file",r),n&&n(c)}else alert(s.f.getI18NValue("support.request.empty.attachment.message"))}}function m(e){var t=e.split(".").pop().toLowerCase();return-1!==["ade","adp","bat","chm","cmd","com","cpl","exe","hta","ins","isp","jar","lib","lnk","mde","msc","msp","mst","pif","scr","sct","shb","sys","vb","vbe","vxd","wsc","wsf","wsh","jse","vbs"].indexOf(t)}function p(e){return e.length>100}function h(e){return e>20971520}function v(e){var t=0;return e.forEach(function(e){t+=parseInt(e.size)}),t}function g(e,t){return!(!(null!==e.types||e.files&&e.files.length>0)||t.fromPaste||!(e.files&&e.files.length>0||(e.types.indexOf?-1!==e.types.indexOf("Files"):e.types.contains("application/x-moz-file"))||"Files"===e.types[0]))}function x(e,t,n){var a={};a.previewData=t.filter(function(e){return!e.isPreview&&l(e.name)}),a.previewData.filter(function(t,n){t.id===e&&(a.selectedIndex=n)}),n&&n(a)}function N(e,t,n){var a=e.indexOf("/api"),r=e;return a>-1&&(r=e.slice(a,e.length),r+="?orgId="+t+(n?"&inline=true":"")),r}function I(e,t){window.open(N(e,t,!0))}function y(e,t){window.location.href=N(e,t,!1)}function b(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=e.length,u=[],l=[],d=0;if(a&&c>a-n){var f=s.f.getI18NValue("support.attachments.count.exceeds",[a]);return r.a.resolve({isError:!0,errorI18N:f})}for(var h=0;h<c;h++){var v=e[h],g=v||{},x=g.size,N=void 0===x?0:x,I=g.name,y=void 0===I?"":I;if(d+=N,m(y)){var b=s.f.getI18NValue("support.community.attachmentcontent.extensionnotpermitted");u.push({errorI18N:b,fileName:y,errorType:"fileType"})}else if(p(y)){var w=s.f.getI18NValue("support.comments.attachment.fileNameSizeLimitation");u.push({errorI18N:w,fileName:y,errorType:"fileNameSize"})}else if(0===N){var C=s.f.getI18NValue("support.request.empty.attachment.message");u.push({errorI18N:C,fileName:y,errorType:"emptyFile"})}else l.push(v)}if(!l.length){if(1===u.length){var E=u[0].errorI18N;return r.a.resolve({isError:!0,errorI18N:E})}var A=s.f.getI18NValue("support.unable.to.process.your.request");return r.a.resolve({isError:!0,errorI18N:A})}if(0===d){var L=s.f.getI18NValue("support.request.empty.attachment.message");return r.a.resolve({isError:!0,errorI18N:L})}if(d+i>1024*o*1024){var z=s.f.getI18NValue("support.attachments.size.limit.exceeds",[o]);return r.a.resolve({isError:!0,errorI18N:z})}for(var V=[],_=[],k=[],F=function(e){var n=l[e];if(t){var a=new FormData;a.append("file",n);var r=t(a).then(function(e){var t=(e.data||{}).data,n=void 0===t?{}:t,a=n.id;a&&(V.push(n),_.push(a))},function(e){var t=n.name,a=s.f.getI18NValue("support.unable.to.process.your.request");throw u.push({errorI18N:a,fileName:t,errorType:"apiError"}),e});k.push(r)}},O=0;O<l.length;O++)F(O);var j={uploadFiles:V,inValidFiles:u,isError:!1,uploadFileIds:_};return r.a.all(k).then(function(){return j},function(){return V.length?j:{isError:!0,errorI18N:s.f.getI18NValue("support.unable.to.process.your.request")}})}function w(e,t){var n=e.name;return{index:t,isPreview:!0,size:e.size,name:n,href:URL.createObjectURL(e)}}},1776:function(e,t,n){e.exports={container:"CloudAttachmentIframe-module__container",iframe:"CloudAttachmentIframe-module__iframe",closeIcon:"CloudAttachmentIframe-module__closeIcon",loadingCont:"CloudAttachmentIframe-module__loadingCont"}},458:function(e,t,n){"use strict";var a=n(12),r=n.n(a),o=n(9),s=n.n(o),i=n(10),c=n.n(i),u=n(13),l=n.n(u),d=n(14),f=n.n(d),m=n(0),p=n.n(m),h=n(173),v=n.n(h),g=n(16),x=function(e){function t(){return s()(this,t),l()(this,(t.__proto__||r()(t)).apply(this,arguments))}return f()(t,e),c()(t,[{key:"render",value:function(){return p.a.createElement(g.Container,{alignBox:"row",align:"both",className:v.a.container},p.a.createElement(g.Box,{className:v.a.dot}),p.a.createElement(g.Box,{className:v.a.dot}),p.a.createElement(g.Box,{className:v.a.dot}),p.a.createElement(g.Box,{className:v.a.dot}),p.a.createElement(g.Box,{className:v.a.dot}),p.a.createElement(g.Box,{className:v.a.dot}))}}]),t}(p.a.Component);t.a=x},570:function(e,t,n){"use strict";n.r(t);var a=n(12),r=n.n(a),o=n(9),s=n.n(o),i=n(10),c=n.n(i),u=n(13),l=n.n(u),d=n(14),f=n.n(d),m=n(0),p=n.n(m),h=n(1),v=n.n(h),g=n(26),x=n(1776),N=n.n(x),I=n(52),y=n(359),b=n.n(y),w=n(458),C=n(3),E=(n(24),n(242)),A=n(8),L=n(174),z=function(e){function t(e){s()(this,t);var n=l()(this,(t.__proto__||r()(t)).call(this,e));return n.state={},n.onLoad=n.onLoad.bind(n),n.closeCloudAttach=n.closeCloudAttach.bind(n),n.receiveMessage=n.receiveMessage.bind(n),n.addAttchment=n.addAttchment.bind(n),n}return f()(t,e),c()(t,[{key:"componentDidMount",value:function(){window.addEventListener("message",this.receiveMessage),this.setState({isFrameLoaded:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.receiveMessage)}},{key:"onLoad",value:function(){this.setState({isFrameLoaded:!0})}},{key:"closeCloudAttach",value:function(){var e=this.props,t=e.closeIframe,n=e.closeCloudAttach;n(),t&&t()}},{key:"receiveMessage",value:function(e){var t=e.data;console.log("data",t),"closePicker"!=t&&this.addAttchment(t),this.closeCloudAttach()}},{key:"addAttchment",value:function(e){var t=e.totalFiles,n=e.doc,a=this.props,r=a.totalLen,o=void 0===r?0:r,s=a.showMessage,i=a.isFromAttachTab;if(o+t>10&&!i)s({type:"alert",message:A.f.getI18NValue("support.attachments.count.exceeds",[10])});else for(var c=["zohodocs","dropbox","evernote","gdrive","box","skydrive"],u=0;u<c.length;u++){var l=c[u],d={},f=n[l];if(0!=f.length)for(var m=0;m<f.length;m++){var p=f[m],h=p.docId,v=p.docName,g=p.docType,x=decodeURIComponent(v);if(x=this.settingExtensionFile(x,g),""!=Object(L.d)(x))if(Object(L.k)(x))s({type:"alert",message:A.f.getI18NValue("support.community.attachmentcontent.extensionnotpermitted")});else if(Object(L.i)(x))s({type:"alert",message:A.f.getI18NValue("support.comments.attachment.fileNameSizeLimitation")});else{d.name=x,d.isPublic=!1,d.source=l,d.id=h,d.type="file";var N=""+u+m;this.props.addCloudAttch(d,t,N)}else s({type:"alert",message:A.f.getI18NValue("support.community.attachmentcontent.extensionnotpermitted")})}}}},{key:"settingExtensionFile",value:function(e,t){return""==Object(L.d)(e)?("document"==t||"writer"==t?e+=".odt":"presentation"==t||"zohoshow"==t?e+=".odp":"spreadsheet"==t||"zohosheet"==t?e+=".xls":"text"==t?e+=".txt":"file"==t?e+=".docx":"pdf"==t&&(e+=".pdf"),e):e}},{key:"render",value:function(){var e=this.props.orgName,t=this.state.isFrameLoaded,n=encodeURIComponent(""+C.C+C.B+"/"+e+"/CloudAttachment.do?isResponse=true&mode=zg,UTF-8"),a=C.F+"/CloudPicker?sources="+C.z+"&zservice="+C.Z+"&serURL="+n+"$attachLimit=5&frameorigin="+C.C+"&originUrl="+C.C;return p.a.createElement(b.a,{portalId:C.I},p.a.createElement(I.a,{zIndex:"7",isActive:!0},p.a.createElement("div",{className:N.a.container},p.a.createElement("iframe",{src:a,className:N.a.iframe,onLoad:this.onLoad}),t?null:p.a.createElement("div",{className:N.a.loadingCont},p.a.createElement(w.a,null)),p.a.createElement("div",{className:N.a.closeIcon,onClick:this.closeCloudAttach},"X"))))}}]),t}(m.Component);z.propTypes={addCloudAttch:v.a.func,closeCloudAttach:v.a.func,closeIframe:v.a.func,isFromAttachTab:v.a.bool,orgName:v.a.string,showMessage:v.a.func,totalLen:v.a.number},t.default=Object(g.connect)(function(e){return{orgName:e.routing.paramMap.orgName}},{closeCloudAttach:E.a})(z)}}]);