(window.deskappJsonp=window.deskappJsonp||[]).push([[54],{1584:function(e,a,t){},1585:function(e,a,t){e.exports={title:"CollisionHeader-module__title",agents:"CollisionHeader-module__agents",agentRight:"CollisionHeader-module__agentRight",agentLeft:"CollisionHeader-module__agentLeft",countText:"CollisionHeader-module__countText",agentCount:"CollisionHeader-module__agentCount",avatar:"CollisionHeader-module__avatar",agentGroup:"CollisionHeader-module__agentGroup",noViewers:"CollisionHeader-module__noViewers"}},1586:function(e,a,t){e.exports={container:"AvatarCollision-module__container common-module__dInflex",on:"AvatarCollision-module__on",off:"AvatarCollision-module__off",idle:"AvatarCollision-module__idle AvatarCollision-module__on",pop:"AvatarCollision-module__pop common-module__rounded",icon:"AvatarCollision-module__icon common-module__middleBoth common-module__middle"}},1587:function(e,a,t){e.exports={footer:"CollisionFooter-module__footer common-module__offSelection",offline:"CollisionFooter-module__offline",chatIcon:"CollisionFooter-module__chatIcon",chat:"CollisionFooter-module__chat",chatText:"CollisionFooter-module__chatText common-module__offSelection",chatGroupText:"CollisionFooter-module__chatGroupText common-module__offSelection",chatStartIcon:"CollisionFooter-module__chatStartIcon",button:"CollisionFooter-module__button common-module__offSelection",defaultText:"CollisionFooter-module__defaultText"}},1588:function(e,a,t){e.exports={list:"CollisionList-module__list",left:"CollisionList-module__left",message:"CollisionList-module__message",name:"CollisionList-module__name",date:"CollisionList-module__date",changesList:"CollisionList-module__changesList",success:"CollisionList-module__success",replied:"CollisionList-module__replied"}},625:function(e,a,t){"use strict";t.r(a);var n=t(23),o=t.n(n),l=t(12),i=t.n(l),s=t(9),r=t.n(s),c=t(10),u=t.n(c),m=t(13),d=t.n(m),p=t(14),h=t.n(p),f=t(0),C=t.n(f),g=t(1),_=t.n(g),v=(t(32),t(26)),b=(t(1584),t(113)),N=t(65),I=t(24),E=t(1585),y=t.n(E),x=t(1586),M=t.n(x),V=t(64),k=t.n(V),L=t(30),j=function(e){function a(e){return r()(this,a),d()(this,(a.__proto__||i()(a)).call(this,e))}return h()(a,e),u()(a,[{key:"render",value:function(){var e=this.props,a=e.title,t=e.src,n=e.name,o=e.size,l=e.onClick,i=e.needCreateChat,s=e.isLeft,r=e.isIdle;return C.a.createElement("div",{className:M.a.container+" "+(s?M.a.off:r?M.a.idle:M.a.on),onClick:l,"data-id":"collsionPop","data-title":a},C.a.createElement(k.a,{src:t,name:n,size:o,palette:"default",needTitle:!1}),i&&!s&&C.a.createElement("span",{className:M.a.pop,"data-title":a},C.a.createElement("span",{className:M.a.icon},C.a.createElement(L.TopbandFontIcon,{name:"livechat3",size:"13"}))))}}]),a}(C.a.Component),w=j;j.propTypes={isIdle:_.a.bool,isLeft:_.a.bool,name:_.a.string.isRequired,needCreateChat:_.a.bool,onClick:_.a.func,size:_.a.string,src:_.a.string,title:_.a.string},j.defaultProps={needCreateChat:!0,isLeft:!1,isIdle:!1,size:"xmedium"};var T=t(8),F=t(6),G=t(16),U=function(e){function a(){return r()(this,a),d()(this,(a.__proto__||i()(a)).apply(this,arguments))}return h()(a,e),u()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.moduleMeta,n=a.data,o=a.agents,l=a.createChat,i=a.addChatMembers,s=t.tickets.singularLabel,r=n.collidingUsers,c=n.chatId,u=n.chatUsers,m=n.activeUsersLen,d=n.noViewers,p=55*Math.ceil(r.length/4);return C.a.createElement("div",null,C.a.createElement("div",{className:y.a.title,"data-id":"collisionTitle"},T.f.getI18NValue("support.label.collision.detection.agent.active",[s])),C.a.createElement(G.Container,{alignBox:"row",align:"vertical",className:y.a.agents,isCover:!1},C.a.createElement(G.Box,{className:y.a.agentLeft},d?C.a.createElement("span",{className:y.a.noViewers,"data-title":T.f.getI18NValue("support.label.no.active.viewers")},C.a.createElement(L.CommonFontIcon,{name:"deactiveUser",size:"8"})):C.a.createElement("span",{className:y.a.agentCount,"data-title":T.f.getI18NValue("support.label.active.viewers")},m),C.a.createElement("span",{className:y.a.countText},T.f.getI18NValue("support.label.collision.detection.agent.viewing"))),C.a.createElement(G.Box,{flexible:!0,className:y.a.agentRight},C.a.createElement(G.Container,{alignBox:"row",wrap:!0,className:y.a.agentGroup,style:{height:p+"px"}},r.map(function(a,t){var n=a.userAction,r=a.agentId,m=a.time,d=a.leftPos,p=a.topPos,h=o[r],f=h.photoURL,g=h.name||Object(F.e)(h.firstName,h.lastName),_=h.id,v=T.f.getI18NValue("support.label.collision.detection.agent.view",[g]),b=!1,N=!1;"replying"==n?v=T.f.getI18NValue("support.label.collision.detection.agent.reply.txt",[g]):"idle"==n?(v=T.f.getI18NValue("support.label.collision.detection.agent.idle",[g,m]),N=!0):"isLeft"==n&&(b=!0,v=T.f.getI18NValue("support.label.collision.detection.agent.left",[g,s,m]));var I=null,E=!0;return c?(E=!1,u&&-1==u.indexOf(""+_)&&(I=i.bind(e,[_]),E=!0)):(I=l.bind(e,[_]),E=!0),C.a.createElement("div",{className:y.a.avatar,key:r,style:{left:d+"px",top:p+"px"}},C.a.createElement(w,{src:f,name:g,title:v,isLeft:b,isIdle:N,onClick:I,needCreateChat:E}))})))))}}]),a}(C.a.Component),B=U;U.propTypes={addChatMembers:_.a.func,agents:_.a.object,createChat:_.a.func,data:_.a.object,moduleMeta:_.a.object};var z=t(1587),H=t.n(z),P=function(e){function a(){return r()(this,a),d()(this,(a.__proto__||i()(a)).apply(this,arguments))}return h()(a,e),u()(a,[{key:"render",value:function(){var e=this.props,a=e.data,t=e.currentUserId,n=e.joinChat,o=e.leaveChat,l=e.createGroupChat,i=a.chatId,s=a.collidingUsers,r=a.chatUsers,c=r&&-1!=r.indexOf(t);return!i&&s.length>2?C.a.createElement("div",{className:H.a.footer},C.a.createElement("div",{className:H.a.offline},C.a.createElement("span",{className:H.a.chatStartIcon,onClick:l},C.a.createElement(L.TicketsFontIcon,{name:"chChat",size:"12"})),C.a.createElement("span",{className:H.a.chatGroupText,onClick:l},T.f.getI18NValue("support.label.collision.groupchat.start")))):i?C.a.createElement("div",{className:H.a.footer},C.a.createElement(G.Container,{alignBox:"row",align:"vertical",isCover:!1},C.a.createElement(G.Box,{className:H.a.chatIcon},C.a.createElement(L.TicketsFontIcon,{name:"chChat",size:"12"})),C.a.createElement(G.Box,{className:H.a.chat,flexible:!0},C.a.createElement("span",{className:H.a.chatText+" "+(!c&&H.a.defaultText),onClick:c?n:null,"data-id":"ActiveChat"},T.f.getI18NValue("support.label.collision.groupchat.active"))),C.a.createElement("span",{className:H.a.button,onClick:c?o:n,"data-id":"JoinOrLeaveChat"},c?T.f.getI18NValue("support.label.collision.groupchat.leave"):T.f.getI18NValue("support.label.collision.groupchat.join")))):null}}]),a}(C.a.Component),A=P;P.propTypes={createGroupChat:_.a.func,currentUserId:_.a.string,data:_.a.object,joinChat:_.a.func,leaveChat:_.a.func};var S=t(1588),O=t.n(S),W=t(152),R=function(e){function a(){return r()(this,a),d()(this,(a.__proto__||i()(a)).apply(this,arguments))}return h()(a,e),u()(a,[{key:"render",value:function(){var e=this.props,a=e.name,t=e.image,n=e.message,o=e.time,l=e.data,i=void 0===l?[]:l,s=e.action,r=i.map(function(e,a){return C.a.createElement("li",{key:a},e.field," :",C.a.createElement("span",null," ",e.value))});return C.a.createElement(G.Container,{alignBox:"row",className:O.a.list,isCover:!1},C.a.createElement(G.Box,{className:O.a.left},"replied"==s?C.a.createElement(W.a,{iconSize:"19",name:"kbessentialsendmessage",palette:"success",size:"xmedium",isIconBold:!0,iconClass:O.a.replied}):C.a.createElement(k.a,{name:a,size:"xmedium",src:t})),C.a.createElement(G.Box,{flexible:!0},n&&C.a.createElement("p",{className:O.a.message+" "+("replied"==s&&O.a.success)},C.a.createElement("span",{className:O.a.name},a)," ",n),i&&C.a.createElement("ul",{className:O.a.changesList},r),C.a.createElement("p",{className:O.a.date},o)))}}]),a}(C.a.Component),Q=R;R.propTypes={action:_.a.string,data:_.a.array,image:_.a.string,message:_.a.string,name:_.a.string,time:_.a.string};var D=function(e){function a(e){r()(this,a);var t=d()(this,(a.__proto__||i()(a)).call(this,e));return t.state={currentTime:null},t.interval=0,t.createGroupChat=t.createGroupChat.bind(t),t.createChat=t.createChat.bind(t),t.joinChat=t.joinChat.bind(t),t.leaveChat=t.leaveChat.bind(t),t.addChatMembers=t.addChatMembers.bind(t),t}return h()(a,e),u()(a,[{key:"componentDidMount",value:function(){var e=this;this._mount=!0,0==this.interval&&(this.interval=setInterval(function(){e._mount&&e.setState({currentTime:Date.now()})},6e4))}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"createGroupChat",value:function(){var e=this.props,a=e.id,t=e.createGroupChat;t(a)}},{key:"createChat",value:function(e,a){var t=this.props,n=t.id,o=t.createChat,l=t.showMessage;o(n,e).then(function(){jQuery.isFunction(WebMessanger.isChatPaused)&&WebMessanger.isChatPaused()&&l({type:"success",message:T.f.getI18NValue("support.label.collision.chat.pause")})}).catch(function(e){l({type:"alert",message:T.f.getI18NValue("support.label.collision.chat.create.error")})})}},{key:"joinChat",value:function(){var e=this.props,a=e.id,t=e.joinChat,n=e.showMessage;t(a).then(function(){jQuery.isFunction(WebMessanger.isChatPaused)&&WebMessanger.isChatPaused()&&n({type:"success",message:T.f.getI18NValue("support.label.collision.chat.pause")})}).catch(function(){n({type:"alert",message:T.f.getI18NValue("support.label.collision.chat.join.error")})})}},{key:"leaveChat",value:function(){var e=this.props,a=e.id,t=e.leaveChat,n=e.showMessage;t(a).then(function(){jQuery.isFunction(WebMessanger.isChatPaused)&&WebMessanger.isChatPaused()&&n({type:"success",message:T.f.getI18NValue("support.label.collision.chat.pause")})}).catch(function(){n({type:"alert",message:T.f.getI18NValue("support.label.collision.chat.leave.error")})})}},{key:"addChatMembers",value:function(e){var a=this.props,t=a.id,n=a.addChatMembers;n(t,e)}},{key:"render",value:function(){var e=this.props,a=e.data,t=e.agents,n=e.moduleMeta,l=(e.usersLength,e.collisionNotificationList),i=e.currentUserId,s=(e.joinChat,e.leaveChat,[].concat(o()(l)).reverse());return C.a.createElement(N.Card,null,C.a.createElement(N.CardHeader,null,C.a.createElement(B,{data:a,moduleMeta:n,agents:t,createChat:this.createChat,addChatMembers:this.addChatMembers})),C.a.createElement(N.CardContent,null,s.map(function(e,a){var n=e.actionBy,o=e.message,l=e.mode,i=e.notificationTime,s=e.action,r=void 0===s?"":s,c=t[n];if(c&&"userIn"!=l&&"userOut"!=l){var u="",m=Date.now()-i,d=Math.floor(m/864e5),p=Math.floor(m%864e5/36e5),h=Math.floor(m%864e5%36e5/6e4);Math.floor(m%864e5%36e5%6e4/1e3);return d>0&&(u+=d>1?d+" "+T.f.getI18NValue("days")+" ":d+" "+T.f.getI18NValue("day")+" "),p>0&&(u+=p>1?p+" "+T.f.getI18NValue("hours")+" ":p+" "+T.f.getI18NValue("hour")+" "),h>0?u+=h>1?h+" "+T.f.getI18NValue("minutes")+" ":h+" "+T.f.getI18NValue("minute")+" ":u=T.f.getI18NValue("label.few")+" "+T.f.getI18NValue("seconds")+" ",""!=u&&(u+=" "+T.f.getI18NValue("ago")),C.a.createElement(Q,{image:c.photoURL,name:c.name||Object(F.e)(c.firstName,c.lastName),message:o,time:u,action:r})}return null})),C.a.createElement(N.CardFooter,null,C.a.createElement(A,{joinChat:this.joinChat,leaveChat:this.leaveChat,createGroupChat:this.createGroupChat,data:a,currentUserId:i})))}}]),a}(f.Component);D.propTypes={addChatMembers:_.a.func,agents:_.a.object,collisionNotificationList:_.a.array,createChat:_.a.func,createGroupChat:_.a.func,currentUserId:_.a.string,data:_.a.object,id:_.a.string,joinChat:_.a.func,leaveChat:_.a.func,moduleMeta:_.a.object,showMessage:_.a.func,usersLength:_.a.number};a.default=Object(v.connect)(function(e,a){return{agents:e.module.agent,moduleMeta:e.moduleMeta,currentUserId:e.myInfo.id}},{createGroupChat:b.d,createChat:b.c,showMessage:I.Q,joinChat:b.f,leaveChat:b.g,addChatMembers:b.a})(D)}}]);