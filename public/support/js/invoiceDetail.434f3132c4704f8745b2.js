(window.deskappJsonp=window.deskappJsonp||[]).push([[85],{1069:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return a});var i=function(e){return e.module.profile[e.myInfo.profileId].permissions.financeInteg},c=function(e){return"ENABLED"===e.integrations.INVOICE.status?"invoice":"ENABLED"===e.integrations.BOOKS.status?"books":null},a=function(e){return"ENABLED"===e.integrations.INVOICE.status?"ZohoInvoice":"ENABLED"===e.integrations.BOOKS.status?"ZohoBooks":null}},1096:function(e,t,n){"use strict";(function(e){n.d(t,"n",function(){return p}),n.d(t,"l",function(){return f}),n.d(t,"a",function(){return m}),n.d(t,"k",function(){return v}),n.d(t,"j",function(){return y}),n.d(t,"B",function(){return b}),n.d(t,"A",function(){return E}),n.d(t,"r",function(){return O}),n.d(t,"b",function(){return g}),n.d(t,"q",function(){return h}),n.d(t,"o",function(){return N}),n.d(t,"f",function(){return T}),n.d(t,"g",function(){return k}),n.d(t,"p",function(){return j}),n.d(t,"m",function(){return Z}),n.d(t,"t",function(){return C}),n.d(t,"u",function(){return _}),n.d(t,"s",function(){return A}),n.d(t,"z",function(){return M}),n.d(t,"w",function(){return L}),n.d(t,"d",function(){return V}),n.d(t,"v",function(){return w}),n.d(t,"c",function(){return F}),n.d(t,"x",function(){return D}),n.d(t,"e",function(){return P}),n.d(t,"i",function(){return z}),n.d(t,"h",function(){return x}),n.d(t,"y",function(){return H});var i=n(19),c=n.n(i),a=n(3),o=n(17),r=n(24),s=n(8),u=n(15),d=n(6),l=n(46),I=n(1069);function p(e,t,n,i){return{types:Object(d.m)("GETINVOICES"),callAPI:function(c){var o=t&&"all"!=t?"&status="+t:"",r="";"Cases"===e&&(r="&departmentId="+c.module.ticket[n].departmentId);var s="pageNumber="+i+"&deskEntityId="+n+"&deskModuleName="+e+o+r;return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(c)+"/invoices?"+s,!1,{orgId:c.currentOrgId}).get().then(function(e){return{data:204!=e.responseStatus?e.data:[],pageNumber:i}})}}}e.ZInvoice={};var f=function(e,t,n,i){return{types:Object(d.m)("GETESTIMATES"),callAPI:function(c){var o="pageNumber="+i+"&deskEntityId="+n+"&deskModuleName="+e+(t&&"all"!=t?"&status="+t:"");return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(c)+"/estimates?"+o,!1,{orgId:c.currentOrgId}).get().then(function(e){return{data:204!=e.responseStatus?e.data:[],pageNumber:i}})}}},m=function(e){return{type:"CHANGE_FINANCE_ENTITY",data:{entity:e.entity,module:e.module,status:e.status}}};function v(e,t){return{types:Object(d.m)("GETACTIVITY"),callAPI:function(n){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(n)+"/contacts/"+e+"/activity?pageNumber="+t,!1,{orgId:n.currentOrgId}).get().then(function(e){return{data:204!=e.responseStatus?e.data:[]}})}}}function y(e){return{types:Object(d.m)("DELINKCONTACT"),callAPI:function(t){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(t)+"/contacts/disassociate?deskEntityId="+e,!1,{orgId:t.currentOrgId}).del().then(function(e){return e})}}}function b(e,t){return{types:Object(d.m)("UPDATE_INVOICE_STATUS"),callAPI:function(n){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(n)+"/invoices/"+e,!1,{orgId:n.currentOrgId}).patch("",{status:t}).then(function(e){return e})}}}function E(e,t){return{types:Object(d.m)("UPDATE_ESTIMATE_STATUS"),callAPI:function(n){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(n)+"/estimates/"+e,!1,{orgId:n.currentOrgId}).patch("",{status:t}).then(function(e){return e})}}}function O(e){return{types:Object(d.m)("MARKALL_INVOICE_SENT"),callAPI:function(t){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(t)+"/invoices/markAsSent",!1,{orgId:t.currentOrgId}).post("",{ids:e}).then(function(e){return e})}}}var g=function(){return{type:"CLEAR_SELECTED_FINANCE_ENTITIES"}};function h(e){return{types:Object(d.m)("MARKALL_ESTIMATE_SENT"),callAPI:function(t){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(t)+"/estimates/markAsSent",!1,{orgId:t.currentOrgId}).post("",{ids:e}).then(function(e){return e})}}}function N(){return{types:Object(d.m)("GET_PAYMENTMETA"),callAPI:function(e){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(e)+"/paymentTermsMeta",!1,{orgId:e.currentOrgId}).get().then(function(e){return e})}}}function T(e){return{types:Object(d.m)("CREATE_CONTACT"),callAPI:function(t,n){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(t)+"/contacts",!1,{orgId:t.currentOrgId}).post("",e).then(function(e){return e})}}}function k(e,t){return{types:Object(d.m)("CREATE_CONTACT_MAPPING"),callAPI:function(n,i){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(n)+"/contacts/"+t,!1,{orgId:n.currentOrgId}).patch("",e).then(function(e){return e})}}}function S(e,t){var n={Cases:"tickets",Contacts:"contacts",Accounts:"accounts"};return{types:Object(d.m)("HAS_UNBILLED_TIMEENTRY"),callAPI:function(i){var c="Cases"!=t?Object(l.a)(i,!0):"",o=""+a.w+n[t]+"/"+e+"/timeEntry?isBillable=true"+c;return Object(u.a)(o,!1,{orgId:i.currentOrgId}).get().then(function(e){return{hasUnBilledTimeEntry:204!=e.responseStatus&&e.data.some(function(e){return null==e.invoiceId})}})}}}function j(e){return{types:Object(d.m)("GET_UNBILLED_TIMEENTRY"),callAPI:function(t){return Object(u.a)(e,!1,{orgId:t.currentOrgId}).get().then(function(e){return e})}}}function Z(e){return{types:Object(d.m)("GET_FINACE_ENTITY"),callAPI:function(t){return Object(u.a)(e,!1,{orgId:t.currentOrgId}).get().then(function(e){return e})}}}function C(e,t){return{type:"CHANGE_INVOICE_MODULE",data:{module:e,status:t}}}function _(e){return{type:"CHANGE_INVOICE_STATUS",data:{status:e}}}function A(e){return{type:"SELECT_INVOICE",data:{selectedItem:e}}}function M(){return{type:"RESET_INVOICE_DEFAULT_DATA"}}function L(e){return{type:"OPEN_INVOICE_DETAILS",data:e}}function V(){return{type:"CLOSE_INVOICE_DETAILS"}}function w(e){return{type:"OPEN_INVOICE_IFRAME_FORM",data:e}}function F(){return{type:"CLOSE_INVOICE_IFRAME_FORM"}}function D(e){return{type:"OPEN_INVOICE_FORM",data:e}}function P(){return{type:"CLOSE_INVOICE_FORM"}}var B=function(e){var t=e.integrations,n=Object(o.I)(e),i=a.l[n],r=e.routing.paramMap.moduleId,s=e.module[i.stateKey][r];return{integrations:t,moduleId:r,contactId:"tickets"===n?s.contactId:r,moduleData:s,deskModuleName:i.deskModuleName,orgName:Object(o.O)(e),financeContact:c()("financeInfo.financeContact",e)||{}}},z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n,i){var c=i(),a=B(c),o=a.moduleId,r=a.deskModuleName,s=a.moduleData,u=a.orgName,d=a.financeContact,l=a.integrations;ZInvoice.entityType="invoice",ZInvoice.isDetailView=!1,ZInvoice.includeTimeEntries=!1;var p=function(i){if(!i){ZInvoice.isHasUnbilledTimeEntries=!1,"Cases"===r?(ZInvoice.caseSubject="[## "+s.ticketNumber+" ##] "+s.subject,ZInvoice.caseId=s.id):(ZInvoice.caseSubject="",ZInvoice.caseId="");var a="/support/"+u+"/connectzb?entityType=2&acceptJHTML=true&entityid="+d.id+"&accountType="+Object(I.a)(c);return n(w({isOpen:!0,src:a,openFinance:e}))}ZInvoice.includeTimeEntries=!0,ZInvoice.isHasUnbilledTimeEntries=!0;var o=t.timeEntryIds;return n(D({type:"invoiceForm",data:{isPreferenceOpen:!0,financeContact:d,timeEntryIds:void 0===o?[]:o},accountType:"ENABLED"==l.INVOICE.status?"invoice":"books",entity:"invoice"}))},f=t.timeEntryIds;return(void 0===f?[]:f).length?p(!0):n(S(o,r)).then(function(e){return p(e.data.hasUnBilledTimeEntry)})}},x=function(e){return function(t,n){var i=n(),c=B(i),a=c.moduleData,o=c.deskModuleName,r=c.orgName,s=c.financeContact;return ZInvoice.includeTimeEntries=!1,ZInvoice.isDetailView=!1,ZInvoice.entityType="estimate","Cases"===o?(ZInvoice.caseSubject="[## "+a.ticketNumber+" ##] "+a.subject,ZInvoice.caseId=a.id):(ZInvoice.caseSubject="",ZInvoice.caseId=""),t(w({isOpen:!0,src:"/support/"+r+"/connectzb?entityType=1&acceptJHTML=true&entityid="+s.id+"&accountType="+Object(I.a)(i),openFinance:e}))}},H=function(e,t,n){return function(i,c){var o=c(),l=B(o),p=l.contactId,f=l.deskModuleName,m=l.integrations;return i(function(e,t){return{types:Object(d.m)("SEARCHCONTACTS"),callAPI:function(n){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(n)+"/contacts/search?deskEntityId="+e+"&deskModuleName="+t,!1,{orgId:n.currentOrgId}).get().then(function(e){return e})}}}(p,f)).then(function(c){return c.data&&"contactId"==c.data.matchedBy?i(function(e,t){return{types:Object(d.m)("FINANCECONTACT"),callAPI:function(n){return Object(u.a)(a.w+"zohoFinance/"+Object(I.c)(n)+"/contacts?deskEntityId="+e+"&deskModuleName="+t,!1,{orgId:n.currentOrgId}).get().then(function(e){return e})}}}(p,f)).then(function(){"invoice"===t?i(z(e,n)):"estimate"===t?i(x(e)):e()}):(i(D({type:"invoiceForm",data:204!=c.data.responseStatus?c.data:null,accountType:"ENABLED"==m.INVOICE.status?"invoice":"books",openFinance:e,entity:t})),{isInvoiceInfoOpen:!1})}).catch(function(e){throw i(Object(r.Q)({type:"alert",message:s.f.getI18NValue("support.invoice.integ.email.error")})),e})}}}).call(this,n(68))},1479:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return I});var i=n(27),c=n.n(i),a=n(1096),o=n(17),r=n(8),s=n(24),u=n(3),d=n(6),l=n(1069),I=function(t){return function(n,i){function I(){var e=i().financeInfo,t=e.selectedModule,c=e.selectedStatus;"invoices"===ZInvoice.entityType||"invoice"===ZInvoice.entityType?n(Object(a.a)({entity:"invoice",module:t,status:c})):"estimates"!==ZInvoice.entityType&&"estimate"!==ZInvoice.entityType||n(Object(a.a)({entity:"estimate",module:t,status:c})),ZInvoice.saveAndSend=!1,ZInvoice.refreshList=!1}function f(e,c,r){ZInvoice.entityId=e;var s=i(),u=Object(o.O)(s),d=Object(l.b)(s),I="/support/"+u+"/connectzb?entityType="+("invoice"==c?"12":"13")+"&acceptJHTML=true&entityid="+e+"&accountType="+Object(l.a)(s);n(Object(a.w)({isOpen:!0,invoiceId:e,type:c,status:r,src:I,permissions:d})),t&&t(),ZInvoice.isShowIframe&&n(Object(a.c)())}e.ZInvoice.saveAndSend=!0,e.setZFIframeHeight=function(){p()},e.setIFrameHeight=function(){p()},e.scroll=function(){ZInvoice.scrollCont.scrollTop=0},e.csrfParamName="crmcsrfparam",e.csrfToken=Object(d.p)(),e.closeZBInvoiceIFrame=function(){ZInvoice.caseId="";var e=i();ZInvoice.saveAndSend&&!0===ZInvoice.refreshList&&I(),e.invoiceIframeFormInfo.isOpen?n(Object(a.c)()):n(Object(a.d)())},e.procZInvoiceResp=function(e,t,i,a){var o=void 0,u=void 0;try{o=(u="object"===(void 0===e?"undefined":c()(e))?e:jQuery.parseJSON(e)).code}catch(e){return void n(Object(s.Q)({type:"alert",message:r.f.getI18NValue("support.unable.to.process.your.request")}))}ZInvoice.saveAndSend=i,0==o&&(n(Object(s.Q)({type:"success",message:u.message})),ZInvoice.caseId="",ZInvoice.isShowIframe=!0,!0===ZInvoice.refreshList?("invoices"===ZInvoice.entityType||"invoice"===ZInvoice.entityType?f(ZInvoice.entityId,"invoice","sent"):"estimates"!==ZInvoice.entityType&&"estimate"!==ZInvoice.entityType||f(ZInvoice.entityId,"estimate","sent"),I(),ZInvoice.refreshList=!1,ZInvoice.saveAndSend=!1):i||(null!=u.estimate&&null!=u.estimate?f(u.estimate.estimate_id,"estimate",u.estimate.status):null!=u.invoice&&null!=u.invoice&&f(u.invoice.invoice_id,"invoice",u.invoice.status),I())),i&&ZInvoice.processSaveAndSend(u)},ZInvoice.setupDevelopmentURL=function(){},ZInvoice.loadPDF=function(e,t){var n=i(),c=Object(o.O)(n);window.location.href="/support/"+c+"/connectzb?entityType="+e+"&entityid="+t+"&accountType="+Object(l.a)(n)},ZInvoice.downloadZFJsp=function(e,t,c){var r=i(),s="/support/"+Object(o.O)(r)+"/connectzb?acceptJHTML=true&entityid="+t+"&accountType="+Object(l.a)(r);ZInvoice.isDetailView=!1;var d="";c?(ZInvoice.refreshList=!0,d=e?u.t.INVOICE_EMAIL_GET:u.t.ESTIMATE_EMAIL_GET):(ZInvoice.refreshList=!1,d=e?u.t.ZB_INVOICE_EDIT:u.t.ZB_ESTIMATE_EDIT),s+="&entityType="+d,n(Object(a.v)({isOpen:!0,src:s}))},ZInvoice.processSaveAndSend=function(e){var t=!1,n=void 0;e.hasOwnProperty("invoice")?(n=e.invoice.invoice_id,ZInvoice.isShowIframe=!1,f(n,"invoice",e.invoice.status),t=!0):e.hasOwnProperty("estimate")&&(n=e.estimate.estimate_id,ZInvoice.isShowIframe=!1,f(n,"estimate",e.estimate.status)),ZInvoice.downloadZFJsp(t,n,!0)},ZInvoice.getTimeEntryJSON=function(){n(Object(a.x)({type:"invoiceForm",data:{isPreferenceOpen:!0,needJSONresponse:!0},accountType:"invoice",entity:"invoice"}))},ZInvoice.devObject={userParam:null,branchParam:null}}};function p(){if(ZInvoice.iframe){var e=ZInvoice.iframe.contentDocument.getElementsByClassName("body")[0];if(e){var t=e.offsetHeight+100;ZInvoice.iframe.setAttribute("height",t+"px")}}if(ZInvoice.dvIframe){var n=ZInvoice.dvIframe.contentDocument.getElementsByTagName("body")[0];if(n){var i=n.offsetHeight+100;ZInvoice.dvIframe.setAttribute("height",i+"px")}}}}).call(this,n(68))},173:function(e,t,n){e.exports={container:"Loading-module__container",dot:"Loading-module__dot",bounce:"Loading-module__bounce"}},1773:function(e,t,n){e.exports={container:"InvoiceDetail-module__container",closeIcon:"InvoiceDetail-module__closeIcon",loadingCont:"InvoiceDetail-module__loadingCont"}},458:function(e,t,n){"use strict";var i=n(12),c=n.n(i),a=n(9),o=n.n(a),r=n(10),s=n.n(r),u=n(13),d=n.n(u),l=n(14),I=n.n(l),p=n(0),f=n.n(p),m=n(173),v=n.n(m),y=n(16),b=function(e){function t(){return o()(this,t),d()(this,(t.__proto__||c()(t)).apply(this,arguments))}return I()(t,e),s()(t,[{key:"render",value:function(){return f.a.createElement(y.Container,{alignBox:"row",align:"both",className:v.a.container},f.a.createElement(y.Box,{className:v.a.dot}),f.a.createElement(y.Box,{className:v.a.dot}),f.a.createElement(y.Box,{className:v.a.dot}),f.a.createElement(y.Box,{className:v.a.dot}),f.a.createElement(y.Box,{className:v.a.dot}),f.a.createElement(y.Box,{className:v.a.dot}))}}]),t}(f.a.Component);t.a=b},568:function(e,t,n){"use strict";n.r(t);var i=n(12),c=n.n(i),a=n(9),o=n.n(a),r=n(10),s=n.n(r),u=n(13),d=n.n(u),l=n(14),I=n.n(l),p=n(0),f=n.n(p),m=n(57),v=n.n(m),y=n(1),b=n.n(y),E=n(26),O=n(1773),g=n.n(O),h=n(1096),N=n(24),T=n(30),k=n(16),S=n(458),j=n(8),Z=n(17),C=n(3),_=n(1479),A=n(1069),M=function(e){function t(e){o()(this,t);var n=d()(this,(t.__proto__||c()(t)).call(this,e));return n.state={},n.onLoad=n.onLoad.bind(n),n.updateStatus=n.updateStatus.bind(n),n.statusSuccessCallback=n.statusSuccessCallback.bind(n),n.viewFinace=n.viewFinace.bind(n),n.cloneEntity=n.cloneEntity.bind(n),n.convertEstimateToInvoice=n.convertEstimateToInvoice.bind(n),n}return I()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.invoiceInit(),this.setState({isFrameLoaded:!1})}},{key:"componentDidUpdate",value:function(e){e.info.invoiceId!=this.props.info.invoiceId&&this.setState({isFrameLoaded:!1})}},{key:"componentWillUnmount",value:function(){ZInvoice.dvIframe=null,this.props.closeInvoiceDetails()}},{key:"onLoad",value:function(){this.setState({isFrameLoaded:!0});var e=this.props.info,t=e.type,n=e.status,i=e.invoiceId,c=e.permissions;if("invoice"==t&&c.createInvoice||"estimate"==t&&c.createEstimate){var a=ZInvoice.dvIframe.contentDocument.getElementById("btnToolbar"),o=document.createElement("div");o.setAttribute("id","deskTab"),a.appendChild(o);var r=ZInvoice.dvIframe.contentDocument.getElementById("deskTab");v.a.render(this.constructMoreObj(n,i,t),r)}}},{key:"updateStatus",value:function(e,t,n){var i=this,c=this.props,a=c.updateInvoiceStatus,o=c.updateEstimateStatus;"invoice"==e?a(t,n).then(function(){i.statusSuccessCallback(e,n),i.viewFinace(t,e,n)}):o(t,n).then(function(){i.statusSuccessCallback(e,n),i.viewFinace(t,e,n)})}},{key:"statusSuccessCallback",value:function(e,t){var n=this.props,i=n.showMessage,c=n.selectedModule,a=n.selectedStatus,o=n.ticket,r=n.contactId,s=n.getInvoices,u=n.getEstimates,d=n.deskModuleName,l=n.ticketSelectedLabel,I=r,p=d,f=a.toLowerCase().replace(" ","_");"Cases"===d&&(c===l?I=o.id:p="Contacts"),"invoice"==e?(i({type:"success",message:j.f.getI18NValue("support.finance.staus.update",[j.f.getI18NValue("support.invoice.label.for.ticket"),t])}),s(p,f,I,1)):(i({type:"success",message:j.f.getI18NValue("support.finance.staus.update",[j.f.getI18NValue("support.estimate.label.for.ticket"),t])}),u(p,f,I,1))}},{key:"viewFinace",value:function(e,t,n){ZInvoice.entityId=e;var i=this.props,c=i.financePermissions,a=i.orgName,o=i.openInvoiceDetails,r="/support/"+a+"/connectzb?entityType="+("invoice"==t?"12":"13")+"&acceptJHTML=true&entityid="+e+"&accountType="+i.accountType;o({isOpen:!0,invoiceId:e,type:t,status:n,src:r,permissions:c}),ZInvoice.dvIframe.src=r}},{key:"cloneEntity",value:function(e,t){var n=this.props,i=n.orgName,c=n.openIframeForm,a=n.accountType;ZInvoice.isDetailView=!1,ZInvoice.entityType=t,c({isOpen:!0,src:"/support/"+i+"/connectzb?entityType="+("invoices"===t||"invoice"===t?C.t.ZB_INVOICE_CLONE:C.t.ZB_ESTIMATE_CLONE)+"&acceptJHTML=true&entityid="+e+"&accountType="+a})}},{key:"convertEstimateToInvoice",value:function(e){var t=this.props,n=t.ticket,i=t.orgName,c=t.openIframeForm,a=t.deskModuleName,o=t.accountType;ZInvoice.isDetailView=!1,ZInvoice.entityType="invoices","Cases"===a&&(ZInvoice.caseId=n.id),c({isOpen:!0,src:"/support/"+i+"/connectzb?entityType="+C.t.ZB_ESTIMATE_TO_INVOICE+"&acceptJHTML=true&entityid="+e+"&accountType="+o})}},{key:"constructMoreObj",value:function(e,t,n){var i=[];return i="invoice"==n?"sent"==e?[{name:j.f.getI18NValue("support.finance.void.invoice"),click:this.updateStatus.bind(this,n,t,"void")},{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"draft"==e?[{name:j.f.getI18NValue("support.finance.mark.as.sent"),click:this.updateStatus.bind(this,n,t,"sent")},{name:j.f.getI18NValue("support.finance.void.invoice"),click:this.updateStatus.bind(this,n,t,"void")},{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"void"==e?[{name:j.f.getI18NValue("support.finance.convert.to.draft"),click:this.updateStatus.bind(this,n,t,"draft")},{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"overdue"==e?[{name:j.f.getI18NValue("support.finance.void.invoice"),click:this.updateStatus.bind(this,n,t,"void")},{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:[{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"draft"==e?[{name:j.f.getI18NValue("support.finance.mark.as.sent"),click:this.updateStatus.bind(this,n,t,"sent")},{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"sent"==e?[{name:j.f.getI18NValue("support.finance.mark.as.accepted"),click:this.updateStatus.bind(this,n,t,"accepted")},{name:j.f.getI18NValue("support.finance.mark.as.declined"),click:this.updateStatus.bind(this,n,t,"declined")},{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"accepted"==e?[{name:j.f.getI18NValue("support.finance.mark.as.declined"),click:this.updateStatus.bind(this,n,t,"declined")},{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:"declined"==e?[{name:j.f.getI18NValue("support.finance.mark.as.accepted"),click:this.updateStatus.bind(this,n,t,"accepted")},{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}]:[{name:j.f.getI18NValue("support.finance.clone.entity"),click:this.cloneEntity.bind(this,t,n)}],f.a.createElement("div",{style:{right:"86px",float:"right",position:"absolute",top:"22px"}},"estimate"==n&&"declined"!=e?f.a.createElement("button",{className:"btn-blue",onClick:this.convertEstimateToInvoice.bind(this,t),style:{float:"left",marginRight:"12px",padding:"5px 12px"},type:"button"},j.f.getI18NValue("support.finance.convert.to.invoice")):null,f.a.createElement("div",{className:"btn-group"},f.a.createElement("button",{className:"btn dropdown-toggle btn-default","data-test-button":"more-options","data-toggle":"dropdown"},j.f.getI18NValue("crm.label.More")," ",f.a.createElement("b",{className:"caret"})),f.a.createElement("ul",{className:"dropdown-menu pull-right"},i.map(function(e,t){return f.a.createElement("li",{"data-test-title":"associate-template",key:t,onClick:e.click},f.a.createElement("span",{"data-ember-action":""},e.name))}))))}},{key:"render",value:function(){var e=this.props,t=e.closeInvoiceDetails,n=e.info,i=this.state.isFrameLoaded;return f.a.createElement(k.Container,{className:g.a.container,ref:function(e){ZInvoice.scrollCont=e},scroll:"both"},f.a.createElement("span",{className:g.a.closeIcon,onClick:t},f.a.createElement(T.ChannelsFontIcon,{name:"close2",size:"12"})),f.a.createElement("iframe",{onLoad:this.onLoad,ref:function(e){ZInvoice.dvIframe=e},src:n.src,style:{width:"100%",position:"absolute"}}),i?null:f.a.createElement("div",{className:g.a.loadingCont},f.a.createElement(S.a,null)))}}]),t}(p.Component);M.propTypes={accountType:b.a.string,closeInvoiceDetails:b.a.func,contactId:b.a.string,deskModuleName:b.a.string,financePermissions:b.a.object,getEstimates:b.a.func,getInvoices:b.a.func,info:b.a.object,invoiceInit:b.a.func,openIframeForm:b.a.func,openInvoiceDetails:b.a.func,orgName:b.a.string,selectedModule:b.a.string,selectedStatus:b.a.string,showMessage:b.a.func,ticket:b.a.object,ticketSelectedLabel:b.a.string,updateEstimateStatus:b.a.func,updateInvoiceStatus:b.a.func},t.default=Object(E.connect)(function(e){var t=e.moduleMeta,n=e.moduleMapper[e.routing.paramMap.moduleName],i=C.l[n],c=e.financeInfo,a=c.selectedModule,o=void 0===a?j.f.getI18NValue("support.finance.module.invoices",[t.tickets.singularLabel]):a,r=c.selectedStatus,s=void 0===r?j.f.getI18NValue("support.finance.status.all"):r,u=e.routing.paramMap.moduleId,d="tickets"===n?e.module.ticket[u]:null,l="tickets"===n?d.contactId:u,I=j.f.getI18NValue("support.finance.module.invoices",[e.moduleMeta.tickets.singularLabel]);return{accountType:Object(A.a)(e),ticketSelectedLabel:I,deskModuleName:i.deskModuleName,selectedModule:o,selectedStatus:s,ticket:d,contactId:l,orgName:Object(Z.O)(e),financePermissions:Object(A.b)(e)}},{closeInvoiceDetails:h.d,updateInvoiceStatus:h.B,updateEstimateStatus:h.A,showMessage:N.Q,getInvoices:h.n,getEstimates:h.l,openInvoiceDetails:h.w,openIframeForm:h.v,invoiceInit:_.a})(M)}}]);